<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>JSONLexerBase.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">fastjson</a> &gt; <a href="index.source.html" class="el_package">com.alibaba.fastjson.parser</a> &gt; <span class="el_source">JSONLexerBase.java</span></div><h1>JSONLexerBase.java</h1><pre class="source lang-java linenums">/*
 * Copyright 1999-2019 Alibaba Group.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package com.alibaba.fastjson.parser;

import java.io.Closeable;
import java.math.BigDecimal;
import java.math.BigInteger;
import java.math.MathContext;
import java.util.*;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONException;
import com.alibaba.fastjson.util.IOUtils;

import static com.alibaba.fastjson.parser.JSONToken.*;
import static com.alibaba.fastjson.util.TypeUtils.fnv1a_64_magic_hashcode;
import static com.alibaba.fastjson.util.TypeUtils.fnv1a_64_magic_prime;

/**
 * @author wenshao[szujobs@hotmail.com]
 */
public abstract class JSONLexerBase implements JSONLexer, Closeable {

    protected void lexError(String key, Object... args) {
<span class="fc" id="L38">        token = ERROR;</span>
<span class="fc" id="L39">    }</span>

    protected int                            token;
    protected int                            pos;
    protected int                            features;

    protected char                           ch;
    protected int                            bp;

    protected int                            eofPos;

    /**
     * A character buffer for literals.
     */
    protected char[]                         sbuf;
    protected int                            sp;

    /**
     * number start position
     */
    protected int                            np;

    protected boolean                        hasSpecial;

<span class="fc" id="L63">    protected Calendar                       calendar           = null;</span>
<span class="fc" id="L64">    protected TimeZone                       timeZone           = JSON.defaultTimeZone;</span>
<span class="fc" id="L65">    protected Locale                         locale             = JSON.defaultLocale;</span>

<span class="fc" id="L67">    public int                               matchStat          = UNKNOWN;</span>

<span class="fc" id="L69">    private final static ThreadLocal&lt;char[]&gt; SBUF_LOCAL         = new ThreadLocal&lt;char[]&gt;();</span>

<span class="fc" id="L71">    protected String                         stringDefaultValue = null;</span>
<span class="fc" id="L72">    protected int                            nanos              = 0;</span>

<span class="fc" id="L74">    public JSONLexerBase(int features){</span>
<span class="fc" id="L75">        this.features = features;</span>

<span class="fc bfc" id="L77" title="All 2 branches covered.">        if ((features &amp; Feature.InitStringFieldAsEmpty.mask) != 0) {</span>
<span class="fc" id="L78">            stringDefaultValue = &quot;&quot;;</span>
        }

<span class="fc" id="L81">        sbuf = SBUF_LOCAL.get();</span>

<span class="fc bfc" id="L83" title="All 2 branches covered.">        if (sbuf == null) {</span>
<span class="fc" id="L84">            sbuf = new char[512];</span>
        }
<span class="fc" id="L86">    }</span>

    public final int matchStat() {
<span class="fc" id="L89">        return matchStat;</span>
    }

    /**
     * internal method, don't invoke
     * @param token
     */
    public void setToken(int token) {
<span class="fc" id="L97">        this.token = token;</span>
<span class="fc" id="L98">    }</span>

    public final void nextToken() {
<span class="fc" id="L101">        sp = 0;</span>

        for (;;) {
<span class="fc" id="L104">            pos = bp;</span>

<span class="fc bfc" id="L106" title="All 2 branches covered.">            if (ch == '/') {</span>
<span class="fc" id="L107">                skipComment();</span>
<span class="fc" id="L108">                continue;</span>
            }

<span class="fc bfc" id="L111" title="All 2 branches covered.">            if (ch == '&quot;') {</span>
<span class="fc" id="L112">                scanString();</span>
<span class="fc" id="L113">                return;</span>
            }

<span class="fc bfc" id="L116" title="All 2 branches covered.">            if (ch == ',') {</span>
<span class="fc" id="L117">                next();</span>
<span class="fc" id="L118">                token = COMMA;</span>
<span class="fc" id="L119">                return;</span>
            }

<span class="fc bfc" id="L122" title="All 4 branches covered.">            if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L123">                scanNumber();</span>
<span class="fc" id="L124">                return;</span>
            }

<span class="fc bfc" id="L127" title="All 2 branches covered.">            if (ch == '-') {</span>
<span class="fc" id="L128">                scanNumber();</span>
<span class="fc" id="L129">                return;</span>
            }

<span class="fc bfc" id="L132" title="All 18 branches covered.">            switch (ch) {</span>
                case '\'':
<span class="fc bfc" id="L134" title="All 2 branches covered.">                    if (!isEnabled(Feature.AllowSingleQuotes)) {</span>
<span class="fc" id="L135">                        throw new JSONException(&quot;Feature.AllowSingleQuotes is false&quot;);</span>
                    }
<span class="fc" id="L137">                    scanStringSingleQuote();</span>
<span class="fc" id="L138">                    return;</span>
                case ' ':
                case '\t':
                case '\b':
                case '\f':
                case '\n':
                case '\r':
<span class="fc" id="L145">                    next();</span>
<span class="fc" id="L146">                    break;</span>
                case 't': // true
<span class="fc" id="L148">                    scanTrue();</span>
<span class="fc" id="L149">                    return;</span>
                case 'f': // false
<span class="fc" id="L151">                    scanFalse();</span>
<span class="fc" id="L152">                    return;</span>
                case 'n': // new,null
<span class="fc" id="L154">                    scanNullOrNew();</span>
<span class="fc" id="L155">                    return;</span>
                case 'T':
                case 'N': // NULL
                case 'S':
                case 'u': // undefined
<span class="fc" id="L160">                    scanIdent();</span>
<span class="fc" id="L161">                    return;</span>
                case '(':
<span class="fc" id="L163">                    next();</span>
<span class="fc" id="L164">                    token = LPAREN;</span>
<span class="fc" id="L165">                    return;</span>
                case ')':
<span class="fc" id="L167">                    next();</span>
<span class="fc" id="L168">                    token = RPAREN;</span>
<span class="fc" id="L169">                    return;</span>
                case '[':
<span class="fc" id="L171">                    next();</span>
<span class="fc" id="L172">                    token = LBRACKET;</span>
<span class="fc" id="L173">                    return;</span>
                case ']':
<span class="fc" id="L175">                    next();</span>
<span class="fc" id="L176">                    token = RBRACKET;</span>
<span class="fc" id="L177">                    return;</span>
                case '{':
<span class="fc" id="L179">                    next();</span>
<span class="fc" id="L180">                    token = LBRACE;</span>
<span class="fc" id="L181">                    return;</span>
                case '}':
<span class="fc" id="L183">                    next();</span>
<span class="fc" id="L184">                    token = RBRACE;</span>
<span class="fc" id="L185">                    return;</span>
                case ':':
<span class="fc" id="L187">                    next();</span>
<span class="fc" id="L188">                    token = COLON;</span>
<span class="fc" id="L189">                    return;</span>
                case ';':
<span class="fc" id="L191">                    next();</span>
<span class="fc" id="L192">                    token = SEMI;</span>
<span class="fc" id="L193">                    return;</span>
                case '.':
<span class="fc" id="L195">                    next();</span>
<span class="fc" id="L196">                    token = DOT;</span>
<span class="fc" id="L197">                    return;</span>
                case '+':
<span class="fc" id="L199">                    next();</span>
<span class="fc" id="L200">                    scanNumber();</span>
<span class="fc" id="L201">                    return;</span>
                case 'x':
<span class="fc" id="L203">                    scanHex();</span>
<span class="fc" id="L204">                    return;</span>
                default:
<span class="fc bfc" id="L206" title="All 2 branches covered.">                    if (isEOF()) { // JLS</span>
<span class="fc bfc" id="L207" title="All 2 branches covered.">                        if (token == EOF) {</span>
<span class="fc" id="L208">                            throw new JSONException(&quot;EOF error&quot;);</span>
                        }

<span class="fc" id="L211">                        token = EOF;</span>
<span class="fc" id="L212">                        eofPos = pos = bp;</span>
                    } else {
<span class="fc bfc" id="L214" title="All 4 branches covered.">                        if (ch &lt;= 31 || ch == 127) {</span>
<span class="fc" id="L215">                            next();</span>
<span class="fc" id="L216">                            break;</span>
                        }

<span class="fc" id="L219">                        lexError(&quot;illegal.char&quot;, String.valueOf((int) ch));</span>
<span class="fc" id="L220">                        next();</span>
                    }

<span class="fc" id="L223">                    return;</span>
            }
        }

    }

    public final void nextToken(int expect) {
<span class="fc" id="L230">        sp = 0;</span>

        for (;;) {
<span class="fc bfc" id="L233" title="All 9 branches covered.">            switch (expect) {</span>
                case JSONToken.LBRACE:
<span class="fc bfc" id="L235" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L236">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L237">                        next();</span>
<span class="fc" id="L238">                        return;</span>
                    }
<span class="fc bfc" id="L240" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L241">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L242">                        next();</span>
<span class="fc" id="L243">                        return;</span>
                    }
                    break;
                case JSONToken.COMMA:
<span class="fc bfc" id="L247" title="All 2 branches covered.">                    if (ch == ',') {</span>
<span class="fc" id="L248">                        token = JSONToken.COMMA;</span>
<span class="fc" id="L249">                        next();</span>
<span class="fc" id="L250">                        return;</span>
                    }

<span class="fc bfc" id="L253" title="All 2 branches covered.">                    if (ch == '}') {</span>
<span class="fc" id="L254">                        token = JSONToken.RBRACE;</span>
<span class="fc" id="L255">                        next();</span>
<span class="fc" id="L256">                        return;</span>
                    }

<span class="fc bfc" id="L259" title="All 2 branches covered.">                    if (ch == ']') {</span>
<span class="fc" id="L260">                        token = JSONToken.RBRACKET;</span>
<span class="fc" id="L261">                        next();</span>
<span class="fc" id="L262">                        return;</span>
                    }

<span class="fc bfc" id="L265" title="All 2 branches covered.">                    if (ch == EOI) {</span>
<span class="fc" id="L266">                        token = JSONToken.EOF;</span>
<span class="fc" id="L267">                        return;</span>
                    }

<span class="fc bfc" id="L270" title="All 2 branches covered.">                    if (ch == 'n') {</span>
<span class="fc" id="L271">                        scanNullOrNew(false);</span>
<span class="fc" id="L272">                        return;</span>
                    }
                    break;
                case JSONToken.LITERAL_INT:
<span class="fc bfc" id="L276" title="All 4 branches covered.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L277">                        pos = bp;</span>
<span class="fc" id="L278">                        scanNumber();</span>
<span class="fc" id="L279">                        return;</span>
                    }

<span class="fc bfc" id="L282" title="All 2 branches covered.">                    if (ch == '&quot;') {</span>
<span class="fc" id="L283">                        pos = bp;</span>
<span class="fc" id="L284">                        scanString();</span>
<span class="fc" id="L285">                        return;</span>
                    }

<span class="fc bfc" id="L288" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L289">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L290">                        next();</span>
<span class="fc" id="L291">                        return;</span>
                    }

<span class="fc bfc" id="L294" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L295">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L296">                        next();</span>
<span class="fc" id="L297">                        return;</span>
                    }

                    break;
                case JSONToken.LITERAL_STRING:
<span class="fc bfc" id="L302" title="All 2 branches covered.">                    if (ch == '&quot;') {</span>
<span class="fc" id="L303">                        pos = bp;</span>
<span class="fc" id="L304">                        scanString();</span>
<span class="fc" id="L305">                        return;</span>
                    }

<span class="fc bfc" id="L308" title="All 4 branches covered.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L309">                        pos = bp;</span>
<span class="fc" id="L310">                        scanNumber();</span>
<span class="fc" id="L311">                        return;</span>
                    }

<span class="fc bfc" id="L314" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L315">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L316">                        next();</span>
<span class="fc" id="L317">                        return;</span>
                    }

<span class="fc bfc" id="L320" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L321">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L322">                        next();</span>
<span class="fc" id="L323">                        return;</span>
                    }
                    break;
                case JSONToken.LBRACKET:
<span class="fc bfc" id="L327" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L328">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L329">                        next();</span>
<span class="fc" id="L330">                        return;</span>
                    }

<span class="fc bfc" id="L333" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L334">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L335">                        next();</span>
<span class="fc" id="L336">                        return;</span>
                    }
                    break;
                case JSONToken.RBRACKET:
<span class="fc bfc" id="L340" title="All 2 branches covered.">                    if (ch == ']') {</span>
<span class="fc" id="L341">                        token = JSONToken.RBRACKET;</span>
<span class="fc" id="L342">                        next();</span>
<span class="fc" id="L343">                        return;</span>
                    }
                case JSONToken.EOF:
<span class="fc bfc" id="L346" title="All 2 branches covered.">                    if (ch == EOI) {</span>
<span class="fc" id="L347">                        token = JSONToken.EOF;</span>
<span class="fc" id="L348">                        return;</span>
                    }
                    break;
                case JSONToken.IDENTIFIER:
<span class="fc" id="L352">                    nextIdent();</span>
<span class="fc" id="L353">                    return;</span>
                default:
                    break;
            }

<span class="fc bfc" id="L358" title="All 12 branches covered.">            if (ch == ' ' || ch == '\n' || ch == '\r' || ch == '\t' || ch == '\f' || ch == '\b') {</span>
<span class="fc" id="L359">                next();</span>
<span class="fc" id="L360">                continue;</span>
            }

<span class="fc" id="L363">            nextToken();</span>
<span class="fc" id="L364">            break;</span>
        }
<span class="fc" id="L366">    }</span>

    public final void nextIdent() {
<span class="fc bfc" id="L369" title="All 2 branches covered.">        while (isWhitespace(ch)) {</span>
<span class="fc" id="L370">            next();</span>
        }
<span class="fc bfc" id="L372" title="All 6 branches covered.">        if (ch == '_' || ch == '$' || Character.isLetter(ch)) {</span>
<span class="fc" id="L373">            scanIdent();</span>
        } else {
<span class="fc" id="L375">            nextToken();</span>
        }
<span class="fc" id="L377">    }</span>

    public final void nextTokenWithColon() {
<span class="fc" id="L380">        nextTokenWithChar(':');</span>
<span class="fc" id="L381">    }</span>

    public final void nextTokenWithChar(char expect) {
<span class="fc" id="L384">        sp = 0;</span>

        for (;;) {
<span class="fc bfc" id="L387" title="All 2 branches covered.">            if (ch == expect) {</span>
<span class="fc" id="L388">                next();</span>
<span class="fc" id="L389">                nextToken();</span>
<span class="fc" id="L390">                return;</span>
            }

<span class="fc bfc" id="L393" title="All 12 branches covered.">            if (ch == ' ' || ch == '\n' || ch == '\r' || ch == '\t' || ch == '\f' || ch == '\b') {</span>
<span class="fc" id="L394">                next();</span>
<span class="fc" id="L395">                continue;</span>
            }

<span class="fc" id="L398">            throw new JSONException(&quot;not match &quot; + expect + &quot; - &quot; + ch + &quot;, info : &quot; + this.info());</span>
        }
    }

    public final int token() {
<span class="fc" id="L403">        return token;</span>
    }

    public final String tokenName() {
<span class="fc" id="L407">        return JSONToken.name(token);</span>
    }

    public final int pos() {
<span class="fc" id="L411">        return pos;</span>
    }

    public final String stringDefaultValue() {
<span class="fc" id="L415">        return stringDefaultValue;</span>
    }

    public final Number integerValue() throws NumberFormatException {
<span class="fc" id="L419">        long result = 0;</span>
<span class="fc" id="L420">        boolean negative = false;</span>
<span class="fc bfc" id="L421" title="All 2 branches covered.">        if (np == -1) {</span>
<span class="fc" id="L422">            np = 0;</span>
        }
<span class="fc" id="L424">        int i = np, max = np + sp;</span>
        long limit;
        long multmin;
        int digit;

<span class="fc" id="L429">        char type = ' ';</span>

<span class="fc bfc" id="L431" title="All 4 branches covered.">        switch (charAt(max - 1)) {</span>
            case 'L':
<span class="fc" id="L433">                max--;</span>
<span class="fc" id="L434">                type = 'L';</span>
<span class="fc" id="L435">                break;</span>
            case 'S':
<span class="fc" id="L437">                max--;</span>
<span class="fc" id="L438">                type = 'S';</span>
<span class="fc" id="L439">                break;</span>
            case 'B':
<span class="fc" id="L441">                max--;</span>
<span class="fc" id="L442">                type = 'B';</span>
<span class="fc" id="L443">                break;</span>
            default:
                break;
        }

<span class="fc bfc" id="L448" title="All 2 branches covered.">        if (charAt(np) == '-') {</span>
<span class="fc" id="L449">            negative = true;</span>
<span class="fc" id="L450">            limit = Long.MIN_VALUE;</span>
<span class="fc" id="L451">            i++;</span>
        } else {
<span class="fc" id="L453">            limit = -Long.MAX_VALUE;</span>
        }
<span class="fc" id="L455">        multmin = MULTMIN_RADIX_TEN;</span>
<span class="fc bfc" id="L456" title="All 2 branches covered.">        if (i &lt; max) {</span>
<span class="fc" id="L457">            digit = charAt(i++) - '0';</span>
<span class="fc" id="L458">            result = -digit;</span>
        }
<span class="fc bfc" id="L460" title="All 2 branches covered.">        while (i &lt; max) {</span>
            // Accumulating negatively avoids surprises near MAX_VALUE
<span class="fc" id="L462">            digit = charAt(i++) - '0';</span>
<span class="fc bfc" id="L463" title="All 2 branches covered.">            if (result &lt; multmin) {</span>
<span class="fc" id="L464">                return new BigInteger(numberString(), 10);</span>
            }
<span class="fc" id="L466">            result *= 10;</span>
<span class="fc bfc" id="L467" title="All 2 branches covered.">            if (result &lt; limit + digit) {</span>
<span class="fc" id="L468">                return new BigInteger(numberString(), 10);</span>
            }
<span class="fc" id="L470">            result -= digit;</span>
        }

<span class="fc bfc" id="L473" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc bfc" id="L474" title="All 2 branches covered.">            if (i &gt; np + 1) {</span>
<span class="fc bfc" id="L475" title="All 4 branches covered.">                if (result &gt;= Integer.MIN_VALUE &amp;&amp; type != 'L') {</span>
<span class="fc bfc" id="L476" title="All 2 branches covered.">                    if (type == 'S') {</span>
<span class="fc" id="L477">                        return (short) result;</span>
                    }

<span class="fc bfc" id="L480" title="All 2 branches covered.">                    if (type == 'B') {</span>
<span class="fc" id="L481">                        return (byte) result;</span>
                    }

<span class="fc" id="L484">                    return (int) result;</span>
                }
<span class="fc" id="L486">                return result;</span>
            } else { /* Only got &quot;-&quot; */
<span class="fc" id="L488">                throw new JSONException(&quot;illegal number format : &quot; + numberString());</span>
            }
        } else {
<span class="fc" id="L491">            result = -result;</span>
<span class="fc bfc" id="L492" title="All 4 branches covered.">            if (result &lt;= Integer.MAX_VALUE &amp;&amp; type != 'L') {</span>
<span class="fc bfc" id="L493" title="All 2 branches covered.">                if (type == 'S') {</span>
<span class="fc" id="L494">                    return (short) result;</span>
                }

<span class="fc bfc" id="L497" title="All 2 branches covered.">                if (type == 'B') {</span>
<span class="fc" id="L498">                    return (byte) result;</span>
                }

<span class="fc" id="L501">                return (int) result;</span>
            }
<span class="fc" id="L503">            return result;</span>
        }
    }

    public final void nextTokenWithColon(int expect) {
<span class="fc" id="L508">        nextTokenWithChar(':');</span>
<span class="fc" id="L509">    }</span>

    public float floatValue() {
<span class="fc" id="L512">        String strVal = numberString();</span>
<span class="fc" id="L513">        float floatValue = Float.parseFloat(strVal);</span>
<span class="fc bfc" id="L514" title="All 4 branches covered.">        if (floatValue == 0 || floatValue == Float.POSITIVE_INFINITY) {</span>
<span class="fc" id="L515">            char c0 = strVal.charAt(0);</span>
<span class="pc bpc" id="L516" title="1 of 4 branches missed.">            if (c0 &gt; '0' &amp;&amp; c0 &lt;= '9') {</span>
<span class="fc" id="L517">                throw new JSONException(&quot;float overflow : &quot; + strVal);</span>
            }
        }
<span class="fc" id="L520">        return floatValue;</span>
    }

    public double doubleValue() {
<span class="fc" id="L524">        return Double.parseDouble(numberString());</span>
    }

    public void config(Feature feature, boolean state) {
<span class="fc" id="L528">        features = Feature.config(features, feature, state);</span>

<span class="fc bfc" id="L530" title="All 2 branches covered.">        if ((features &amp; Feature.InitStringFieldAsEmpty.mask) != 0) {</span>
<span class="fc" id="L531">            stringDefaultValue = &quot;&quot;;</span>
        }
<span class="fc" id="L533">    }</span>

    public final boolean isEnabled(Feature feature) {
<span class="fc" id="L536">        return isEnabled(feature.mask);</span>
    }

    public final boolean isEnabled(int feature) {
<span class="fc bfc" id="L540" title="All 2 branches covered.">        return (this.features &amp; feature) != 0;</span>
    }

    public final boolean isEnabled(int features, int feature) {
<span class="pc bpc" id="L544" title="1 of 4 branches missed.">        return (this.features &amp; feature) != 0 || (features &amp; feature) != 0;</span>
    }

    public abstract String numberString();

    public abstract boolean isEOF();

    public final char getCurrent() {
<span class="fc" id="L552">        return ch;</span>
    }

    public abstract char charAt(int index);

    // public final char next() {
    // ch = doNext();
    //// if (ch == '/' &amp;&amp; (this.features &amp; Feature.AllowComment.mask) != 0) {
    //// skipComment();
    //// }
    // return ch;
    // }

    public abstract char next();

    protected void skipComment() {
<span class="fc" id="L568">        next();</span>
<span class="fc bfc" id="L569" title="All 2 branches covered.">        if (ch == '/') {</span>
            for (;;) {
<span class="fc" id="L571">                next();</span>
<span class="fc bfc" id="L572" title="All 2 branches covered.">                if (ch == '\n') {</span>
<span class="fc" id="L573">                    next();</span>
<span class="fc" id="L574">                    return;</span>
<span class="fc bfc" id="L575" title="All 2 branches covered.">                } else if (ch == EOI) {</span>
<span class="fc" id="L576">                    return;</span>
                }
            }
<span class="fc bfc" id="L579" title="All 2 branches covered.">        } else if (ch == '*') {</span>
<span class="fc" id="L580">            next();</span>

<span class="pc bpc" id="L582" title="1 of 2 branches missed.">            for (; ch != EOI;) {</span>
<span class="fc bfc" id="L583" title="All 2 branches covered.">                if (ch == '*') {</span>
<span class="fc" id="L584">                    next();</span>
<span class="fc bfc" id="L585" title="All 2 branches covered.">                    if (ch == '/') {</span>
<span class="fc" id="L586">                        next();</span>
<span class="fc" id="L587">                        return;</span>
                    } else {
                        continue;
                    }
                }
<span class="fc" id="L592">                next();</span>
            }
        } else {
<span class="fc" id="L595">            throw new JSONException(&quot;invalid comment&quot;);</span>
        }
<span class="nc" id="L597">    }</span>

    public final String scanSymbol(final SymbolTable symbolTable) {
<span class="fc" id="L600">        skipWhitespace();</span>

<span class="fc bfc" id="L602" title="All 2 branches covered.">        if (ch == '&quot;') {</span>
<span class="fc" id="L603">            return scanSymbol(symbolTable, '&quot;');</span>
        }

<span class="fc bfc" id="L606" title="All 2 branches covered.">        if (ch == '\'') {</span>
<span class="fc bfc" id="L607" title="All 2 branches covered.">            if (!isEnabled(Feature.AllowSingleQuotes)) {</span>
<span class="fc" id="L608">                throw new JSONException(&quot;syntax error&quot;);</span>
            }

<span class="fc" id="L611">            return scanSymbol(symbolTable, '\'');</span>
        }

<span class="fc bfc" id="L614" title="All 2 branches covered.">        if (ch == '}') {</span>
<span class="fc" id="L615">            next();</span>
<span class="fc" id="L616">            token = JSONToken.RBRACE;</span>
<span class="fc" id="L617">            return null;</span>
        }

<span class="fc bfc" id="L620" title="All 2 branches covered.">        if (ch == ',') {</span>
<span class="fc" id="L621">            next();</span>
<span class="fc" id="L622">            token = JSONToken.COMMA;</span>
<span class="fc" id="L623">            return null;</span>
        }

<span class="fc bfc" id="L626" title="All 2 branches covered.">        if (ch == EOI) {</span>
<span class="fc" id="L627">            token = JSONToken.EOF;</span>
<span class="fc" id="L628">            return null;</span>
        }

<span class="fc bfc" id="L631" title="All 2 branches covered.">        if (!isEnabled(Feature.AllowUnQuotedFieldNames)) {</span>
<span class="fc" id="L632">            throw new JSONException(&quot;syntax error&quot;);</span>
        }

<span class="fc" id="L635">        return scanSymbolUnQuoted(symbolTable);</span>
    }

    // public abstract String scanSymbol(final SymbolTable symbolTable, final char quote);

    protected abstract void arrayCopy(int srcPos, char[] dest, int destPos, int length);

    public final String scanSymbol(final SymbolTable symbolTable, final char quote) {
<span class="fc" id="L643">        int hash = 0;</span>

<span class="fc" id="L645">        np = bp;</span>
<span class="fc" id="L646">        sp = 0;</span>
<span class="fc" id="L647">        boolean hasSpecial = false;</span>
        char chLocal;
        for (;;) {
<span class="fc" id="L650">            chLocal = next();</span>

<span class="fc bfc" id="L652" title="All 2 branches covered.">            if (chLocal == quote) {</span>
<span class="fc" id="L653">                break;</span>
            }

<span class="fc bfc" id="L656" title="All 2 branches covered.">            if (chLocal == EOI) {</span>
<span class="fc" id="L657">                throw new JSONException(&quot;unclosed.str&quot;);</span>
            }

<span class="fc bfc" id="L660" title="All 2 branches covered.">            if (chLocal == '\\') {</span>
<span class="fc bfc" id="L661" title="All 2 branches covered.">                if (!hasSpecial) {</span>
<span class="fc" id="L662">                    hasSpecial = true;</span>

<span class="fc bfc" id="L664" title="All 2 branches covered.">                    if (sp &gt;= sbuf.length) {</span>
<span class="fc" id="L665">                        int newCapcity = sbuf.length * 2;</span>
<span class="pc bpc" id="L666" title="1 of 2 branches missed.">                        if (sp &gt; newCapcity) {</span>
<span class="nc" id="L667">                            newCapcity = sp;</span>
                        }
<span class="fc" id="L669">                        char[] newsbuf = new char[newCapcity];</span>
<span class="fc" id="L670">                        System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="fc" id="L671">                        sbuf = newsbuf;</span>
                    }

                    // text.getChars(np + 1, np + 1 + sp, sbuf, 0);
                    // System.arraycopy(this.buf, np + 1, sbuf, 0, sp);
<span class="fc" id="L676">                    arrayCopy(np + 1, sbuf, 0, sp);</span>
                }

<span class="fc" id="L679">                chLocal = next();</span>

<span class="fc bfc" id="L681" title="All 21 branches covered.">                switch (chLocal) {</span>
                    case '0':
<span class="fc" id="L683">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L684">                        putChar('\0');</span>
<span class="fc" id="L685">                        break;</span>
                    case '1':
<span class="fc" id="L687">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L688">                        putChar('\1');</span>
<span class="fc" id="L689">                        break;</span>
                    case '2':
<span class="fc" id="L691">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L692">                        putChar('\2');</span>
<span class="fc" id="L693">                        break;</span>
                    case '3':
<span class="fc" id="L695">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L696">                        putChar('\3');</span>
<span class="fc" id="L697">                        break;</span>
                    case '4':
<span class="fc" id="L699">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L700">                        putChar('\4');</span>
<span class="fc" id="L701">                        break;</span>
                    case '5':
<span class="fc" id="L703">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L704">                        putChar('\5');</span>
<span class="fc" id="L705">                        break;</span>
                    case '6':
<span class="fc" id="L707">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L708">                        putChar('\6');</span>
<span class="fc" id="L709">                        break;</span>
                    case '7':
<span class="fc" id="L711">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L712">                        putChar('\7');</span>
<span class="fc" id="L713">                        break;</span>
                    case 'b': // 8
<span class="fc" id="L715">                        hash = 31 * hash + (int) '\b';</span>
<span class="fc" id="L716">                        putChar('\b');</span>
<span class="fc" id="L717">                        break;</span>
                    case 't': // 9
<span class="fc" id="L719">                        hash = 31 * hash + (int) '\t';</span>
<span class="fc" id="L720">                        putChar('\t');</span>
<span class="fc" id="L721">                        break;</span>
                    case 'n': // 10
<span class="fc" id="L723">                        hash = 31 * hash + (int) '\n';</span>
<span class="fc" id="L724">                        putChar('\n');</span>
<span class="fc" id="L725">                        break;</span>
                    case 'v': // 11
<span class="fc" id="L727">                        hash = 31 * hash + (int) '\u000B';</span>
<span class="fc" id="L728">                        putChar('\u000B');</span>
<span class="fc" id="L729">                        break;</span>
                    case 'f': // 12
                    case 'F':
<span class="fc" id="L732">                        hash = 31 * hash + (int) '\f';</span>
<span class="fc" id="L733">                        putChar('\f');</span>
<span class="fc" id="L734">                        break;</span>
                    case 'r': // 13
<span class="fc" id="L736">                        hash = 31 * hash + (int) '\r';</span>
<span class="fc" id="L737">                        putChar('\r');</span>
<span class="fc" id="L738">                        break;</span>
                    case '&quot;': // 34
<span class="fc" id="L740">                        hash = 31 * hash + (int) '&quot;';</span>
<span class="fc" id="L741">                        putChar('&quot;');</span>
<span class="fc" id="L742">                        break;</span>
                    case '\'': // 39
<span class="fc" id="L744">                        hash = 31 * hash + (int) '\'';</span>
<span class="fc" id="L745">                        putChar('\'');</span>
<span class="fc" id="L746">                        break;</span>
                    case '/': // 47
<span class="fc" id="L748">                        hash = 31 * hash + (int) '/';</span>
<span class="fc" id="L749">                        putChar('/');</span>
<span class="fc" id="L750">                        break;</span>
                    case '\\': // 92
<span class="fc" id="L752">                        hash = 31 * hash + (int) '\\';</span>
<span class="fc" id="L753">                        putChar('\\');</span>
<span class="fc" id="L754">                        break;</span>
                    case 'x':
<span class="fc" id="L756">                        char x1 = ch = next();</span>
<span class="fc" id="L757">                        char x2 = ch = next();</span>

<span class="fc" id="L759">                        int x_val = digits[x1] * 16 + digits[x2];</span>
<span class="fc" id="L760">                        char x_char = (char) x_val;</span>
<span class="fc" id="L761">                        hash = 31 * hash + (int) x_char;</span>
<span class="fc" id="L762">                        putChar(x_char);</span>
<span class="fc" id="L763">                        break;</span>
                    case 'u':
<span class="fc" id="L765">                        char c1 = chLocal = next();</span>
<span class="fc" id="L766">                        char c2 = chLocal = next();</span>
<span class="fc" id="L767">                        char c3 = chLocal = next();</span>
<span class="fc" id="L768">                        char c4 = chLocal = next();</span>
<span class="fc" id="L769">                        int val = Integer.parseInt(new String(new char[] { c1, c2, c3, c4 }), 16);</span>
<span class="fc" id="L770">                        hash = 31 * hash + val;</span>
<span class="fc" id="L771">                        putChar((char) val);</span>
<span class="fc" id="L772">                        break;</span>
                    default:
<span class="fc" id="L774">                        this.ch = chLocal;</span>
<span class="fc" id="L775">                        throw new JSONException(&quot;unclosed.str.lit&quot;);</span>
                }
                continue;
            }

<span class="fc" id="L780">            hash = 31 * hash + chLocal;</span>

<span class="fc bfc" id="L782" title="All 2 branches covered.">            if (!hasSpecial) {</span>
<span class="fc" id="L783">                sp++;</span>
<span class="fc" id="L784">                continue;</span>
            }

<span class="fc bfc" id="L787" title="All 2 branches covered.">            if (sp == sbuf.length) {</span>
<span class="fc" id="L788">                putChar(chLocal);</span>
            } else {
<span class="fc" id="L790">                sbuf[sp++] = chLocal;</span>
            }
        }

<span class="fc" id="L794">        token = LITERAL_STRING;</span>

        String value;
<span class="fc bfc" id="L797" title="All 2 branches covered.">        if (!hasSpecial) {</span>
            // return this.text.substring(np + 1, np + 1 + sp).intern();
            int offset;
<span class="pc bpc" id="L800" title="1 of 2 branches missed.">            if (np == -1) {</span>
<span class="nc" id="L801">                offset = 0;</span>
            } else {
<span class="fc" id="L803">                offset = np + 1;</span>
            }
<span class="fc" id="L805">            value = addSymbol(offset, sp, hash, symbolTable);</span>
<span class="fc" id="L806">        } else {</span>
<span class="fc" id="L807">            value = symbolTable.addSymbol(sbuf, 0, sp, hash);</span>
        }

<span class="fc" id="L810">        sp = 0;</span>
<span class="fc" id="L811">        this.next();</span>

<span class="fc" id="L813">        return value;</span>
    }

    public final void resetStringPosition() {
<span class="fc" id="L817">        this.sp = 0;</span>
<span class="fc" id="L818">    }</span>

    public String info() {
<span class="fc" id="L821">        return &quot;&quot;;</span>
    }

    public final String scanSymbolUnQuoted(final SymbolTable symbolTable) {
<span class="pc bpc" id="L825" title="2 of 6 branches missed.">        if (token == JSONToken.ERROR &amp;&amp; pos == 0 &amp;&amp; bp == 1) {</span>
<span class="fc" id="L826">            bp = 0; // adjust</span>
        }
<span class="fc" id="L828">        final boolean[] firstIdentifierFlags = IOUtils.firstIdentifierFlags;</span>
<span class="fc" id="L829">        final char first = ch;</span>

<span class="pc bpc" id="L831" title="1 of 4 branches missed.">        final boolean firstFlag = ch &gt;= firstIdentifierFlags.length || firstIdentifierFlags[first];</span>
<span class="fc bfc" id="L832" title="All 2 branches covered.">        if (!firstFlag) {</span>
<span class="fc" id="L833">            throw new JSONException(&quot;illegal identifier : &quot; + ch //</span>
<span class="fc" id="L834">                    + info());</span>
        }

<span class="fc" id="L837">        final boolean[] identifierFlags = IOUtils.identifierFlags;</span>

<span class="fc" id="L839">        int hash = first;</span>

<span class="fc" id="L841">        np = bp;</span>
<span class="fc" id="L842">        sp = 1;</span>
        char chLocal;
        for (;;) {
<span class="fc" id="L845">            chLocal = next();</span>

<span class="pc bpc" id="L847" title="1 of 2 branches missed.">            if (chLocal &lt; identifierFlags.length) {</span>
<span class="fc bfc" id="L848" title="All 2 branches covered.">                if (!identifierFlags[chLocal]) {</span>
<span class="fc" id="L849">                    break;</span>
                }
            }

<span class="fc" id="L853">            hash = 31 * hash + chLocal;</span>

<span class="fc" id="L855">            sp++;</span>
<span class="fc" id="L856">            continue;</span>
        }

<span class="fc" id="L859">        this.ch = charAt(bp);</span>
<span class="fc" id="L860">        token = JSONToken.IDENTIFIER;</span>

<span class="fc" id="L862">        final int NULL_HASH = 3392903;</span>
<span class="pc bpc" id="L863" title="3 of 10 branches missed.">        if (sp == 4 &amp;&amp; hash == NULL_HASH &amp;&amp; charAt(np) == 'n' &amp;&amp; charAt(np + 1) == 'u' &amp;&amp; charAt(np + 2) == 'l'</span>
<span class="pc bpc" id="L864" title="1 of 2 branches missed.">                &amp;&amp; charAt(np + 3) == 'l') {</span>
<span class="fc" id="L865">            return null;</span>
        }

        // return text.substring(np, np + sp).intern();

<span class="pc bpc" id="L870" title="1 of 2 branches missed.">        if (symbolTable == null) {</span>
<span class="nc" id="L871">            return subString(np, sp);</span>
        }

<span class="fc" id="L874">        return this.addSymbol(np, sp, hash, symbolTable);</span>
        // return symbolTable.addSymbol(buf, np, sp, hash);
    }

    protected abstract void copyTo(int offset, int count, char[] dest);

    public final void scanString() {
<span class="fc" id="L881">        np = bp;</span>
<span class="fc" id="L882">        hasSpecial = false;</span>
        char ch;
        for (;;) {
<span class="fc" id="L885">            ch = next();</span>

<span class="fc bfc" id="L887" title="All 2 branches covered.">            if (ch == '\&quot;') {</span>
<span class="fc" id="L888">                break;</span>
            }

<span class="fc bfc" id="L891" title="All 2 branches covered.">            if (ch == EOI) {</span>
<span class="fc bfc" id="L892" title="All 2 branches covered.">                if (!isEOF()) {</span>
<span class="fc" id="L893">                    putChar((char) EOI);</span>
<span class="fc" id="L894">                    continue;</span>
                }
<span class="fc" id="L896">                throw new JSONException(&quot;unclosed string : &quot; + ch);</span>
            }

<span class="fc bfc" id="L899" title="All 2 branches covered.">            if (ch == '\\') {</span>
<span class="fc bfc" id="L900" title="All 2 branches covered.">                if (!hasSpecial) {</span>
<span class="fc" id="L901">                    hasSpecial = true;</span>

<span class="fc bfc" id="L903" title="All 2 branches covered.">                    if (sp &gt;= sbuf.length) {</span>
<span class="fc" id="L904">                        int newCapcity = sbuf.length * 2;</span>
<span class="pc bpc" id="L905" title="1 of 2 branches missed.">                        if (sp &gt; newCapcity) {</span>
<span class="fc" id="L906">                            newCapcity = sp;</span>
                        }
<span class="fc" id="L908">                        char[] newsbuf = new char[newCapcity];</span>
<span class="fc" id="L909">                        System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="fc" id="L910">                        sbuf = newsbuf;</span>
                    }

<span class="fc" id="L913">                    copyTo(np + 1, sp, sbuf);</span>
                    // text.getChars(np + 1, np + 1 + sp, sbuf, 0);
                    // System.arraycopy(buf, np + 1, sbuf, 0, sp);
                }

<span class="fc" id="L918">                ch = next();</span>

<span class="fc bfc" id="L920" title="All 21 branches covered.">                switch (ch) {</span>
                    case '0':
<span class="fc" id="L922">                        putChar('\0');</span>
<span class="fc" id="L923">                        break;</span>
                    case '1':
<span class="fc" id="L925">                        putChar('\1');</span>
<span class="fc" id="L926">                        break;</span>
                    case '2':
<span class="fc" id="L928">                        putChar('\2');</span>
<span class="fc" id="L929">                        break;</span>
                    case '3':
<span class="fc" id="L931">                        putChar('\3');</span>
<span class="fc" id="L932">                        break;</span>
                    case '4':
<span class="fc" id="L934">                        putChar('\4');</span>
<span class="fc" id="L935">                        break;</span>
                    case '5':
<span class="fc" id="L937">                        putChar('\5');</span>
<span class="fc" id="L938">                        break;</span>
                    case '6':
<span class="fc" id="L940">                        putChar('\6');</span>
<span class="fc" id="L941">                        break;</span>
                    case '7':
<span class="fc" id="L943">                        putChar('\7');</span>
<span class="fc" id="L944">                        break;</span>
                    case 'b': // 8
<span class="fc" id="L946">                        putChar('\b');</span>
<span class="fc" id="L947">                        break;</span>
                    case 't': // 9
<span class="fc" id="L949">                        putChar('\t');</span>
<span class="fc" id="L950">                        break;</span>
                    case 'n': // 10
<span class="fc" id="L952">                        putChar('\n');</span>
<span class="fc" id="L953">                        break;</span>
                    case 'v': // 11
<span class="fc" id="L955">                        putChar('\u000B');</span>
<span class="fc" id="L956">                        break;</span>
                    case 'f': // 12
                    case 'F':
<span class="fc" id="L959">                        putChar('\f');</span>
<span class="fc" id="L960">                        break;</span>
                    case 'r': // 13
<span class="fc" id="L962">                        putChar('\r');</span>
<span class="fc" id="L963">                        break;</span>
                    case '&quot;': // 34
<span class="fc" id="L965">                        putChar('&quot;');</span>
<span class="fc" id="L966">                        break;</span>
                    case '\'': // 39
<span class="fc" id="L968">                        putChar('\'');</span>
<span class="fc" id="L969">                        break;</span>
                    case '/': // 47
<span class="fc" id="L971">                        putChar('/');</span>
<span class="fc" id="L972">                        break;</span>
                    case '\\': // 92
<span class="fc" id="L974">                        putChar('\\');</span>
<span class="fc" id="L975">                        break;</span>
                    case 'x':
<span class="fc" id="L977">                        char x1 = next();</span>
<span class="fc" id="L978">                        char x2 = next();</span>

<span class="pc bpc" id="L980" title="4 of 12 branches missed.">                        boolean hex1 = (x1 &gt;= '0' &amp;&amp; x1 &lt;= '9')</span>
                                || (x1 &gt;= 'a' &amp;&amp; x1 &lt;= 'f')
                                || (x1 &gt;= 'A' &amp;&amp; x1 &lt;= 'F');
<span class="pc bpc" id="L983" title="4 of 12 branches missed.">                        boolean hex2 = (x2 &gt;= '0' &amp;&amp; x2 &lt;= '9')</span>
                                || (x2 &gt;= 'a' &amp;&amp; x2 &lt;= 'f')
                                || (x2 &gt;= 'A' &amp;&amp; x2 &lt;= 'F');
<span class="pc bpc" id="L986" title="1 of 4 branches missed.">                        if (!hex1 || !hex2) {</span>
<span class="fc" id="L987">                            throw new JSONException(&quot;invalid escape character \\x&quot; + x1 + x2);</span>
                        }

<span class="fc" id="L990">                        char x_char = (char) (digits[x1] * 16 + digits[x2]);</span>
<span class="fc" id="L991">                        putChar(x_char);</span>
<span class="fc" id="L992">                        break;</span>
                    case 'u':
<span class="fc" id="L994">                        char u1 = next();</span>
<span class="fc" id="L995">                        char u2 = next();</span>
<span class="fc" id="L996">                        char u3 = next();</span>
<span class="fc" id="L997">                        char u4 = next();</span>
<span class="fc" id="L998">                        int val = Integer.parseInt(new String(new char[] { u1, u2, u3, u4 }), 16);</span>
<span class="fc" id="L999">                        putChar((char) val);</span>
<span class="fc" id="L1000">                        break;</span>
                    default:
<span class="fc" id="L1002">                        this.ch = ch;</span>
<span class="fc" id="L1003">                        throw new JSONException(&quot;unclosed string : &quot; + ch);</span>
                }
                continue;
            }

<span class="fc bfc" id="L1008" title="All 2 branches covered.">            if (!hasSpecial) {</span>
<span class="fc" id="L1009">                sp++;</span>
<span class="fc" id="L1010">                continue;</span>
            }

<span class="fc bfc" id="L1013" title="All 2 branches covered.">            if (sp == sbuf.length) {</span>
<span class="fc" id="L1014">                putChar(ch);</span>
            } else {
<span class="fc" id="L1016">                sbuf[sp++] = ch;</span>
            }
        }

<span class="fc" id="L1020">        token = JSONToken.LITERAL_STRING;</span>
<span class="fc" id="L1021">        this.ch = next();</span>
<span class="fc" id="L1022">    }</span>

    public Calendar getCalendar() {
<span class="fc" id="L1025">        return this.calendar;</span>
    }

    public TimeZone getTimeZone() {
<span class="fc" id="L1029">        return timeZone;</span>
    }

    public void setTimeZone(TimeZone timeZone) {
<span class="fc" id="L1033">        this.timeZone = timeZone;</span>
<span class="fc" id="L1034">    }</span>

    public Locale getLocale() {
<span class="fc" id="L1037">        return locale;</span>
    }

    public void setLocale(Locale locale) {
<span class="fc" id="L1041">        this.locale = locale;</span>
<span class="fc" id="L1042">    }</span>

    public final int intValue() {
<span class="pc bpc" id="L1045" title="1 of 2 branches missed.">        if (np == -1) {</span>
<span class="nc" id="L1046">            np = 0;</span>
        }

<span class="fc" id="L1049">        int result = 0;</span>
<span class="fc" id="L1050">        boolean negative = false;</span>
<span class="fc" id="L1051">        int i = np, max = np + sp;</span>
        int limit;
        int digit;

<span class="fc bfc" id="L1055" title="All 2 branches covered.">        if (charAt(np) == '-') {</span>
<span class="fc" id="L1056">            negative = true;</span>
<span class="fc" id="L1057">            limit = Integer.MIN_VALUE;</span>
<span class="fc" id="L1058">            i++;</span>
        } else {
<span class="fc" id="L1060">            limit = -Integer.MAX_VALUE;</span>
        }
<span class="fc" id="L1062">        long multmin = INT_MULTMIN_RADIX_TEN;</span>
<span class="fc bfc" id="L1063" title="All 2 branches covered.">        if (i &lt; max) {</span>
<span class="fc" id="L1064">            digit = charAt(i++) - '0';</span>
<span class="fc" id="L1065">            result = -digit;</span>
        }
<span class="fc bfc" id="L1067" title="All 2 branches covered.">        while (i &lt; max) {</span>
            // Accumulating negatively avoids surprises near MAX_VALUE
<span class="fc" id="L1069">            char chLocal = charAt(i++);</span>

<span class="fc bfc" id="L1071" title="All 6 branches covered.">            if (chLocal == 'L' || chLocal == 'S' || chLocal == 'B') {</span>
<span class="fc" id="L1072">                break;</span>
            }

<span class="fc" id="L1075">            digit = chLocal - '0';</span>

<span class="fc bfc" id="L1077" title="All 2 branches covered.">            if (result &lt; multmin) {</span>
<span class="fc" id="L1078">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L1080">            result *= 10;</span>
<span class="fc bfc" id="L1081" title="All 2 branches covered.">            if (result &lt; limit + digit) {</span>
<span class="fc" id="L1082">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L1084">            result -= digit;</span>
<span class="fc" id="L1085">        }</span>

<span class="fc bfc" id="L1087" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc bfc" id="L1088" title="All 2 branches covered.">            if (i &gt; np + 1) {</span>
<span class="fc" id="L1089">                return result;</span>
            } else { /* Only got &quot;-&quot; */
<span class="fc" id="L1091">                throw new NumberFormatException(numberString());</span>
            }
        } else {
<span class="fc" id="L1094">            return -result;</span>
        }
    }

    public abstract byte[] bytesValue();

    public void close() {
<span class="fc bfc" id="L1101" title="All 2 branches covered.">        if (sbuf.length &lt;= 1024 * 8) {</span>
<span class="fc" id="L1102">            SBUF_LOCAL.set(sbuf);</span>
        }
<span class="fc" id="L1104">        this.sbuf = null;</span>
<span class="fc" id="L1105">    }</span>

    public final boolean isRef() {
<span class="fc bfc" id="L1108" title="All 2 branches covered.">        if (sp != 4) {</span>
<span class="fc" id="L1109">            return false;</span>
        }

<span class="fc bfc" id="L1112" title="All 2 branches covered.">        return charAt(np + 1) == '$' //</span>
<span class="fc bfc" id="L1113" title="All 2 branches covered.">                &amp;&amp; charAt(np + 2) == 'r' //</span>
<span class="fc bfc" id="L1114" title="All 2 branches covered.">                &amp;&amp; charAt(np + 3) == 'e' //</span>
<span class="fc bfc" id="L1115" title="All 2 branches covered.">                &amp;&amp; charAt(np + 4) == 'f';</span>
    }

    public String scanTypeName(SymbolTable symbolTable) {
<span class="fc" id="L1119">        return null;</span>
    }

<span class="fc" id="L1122">    protected final static char[] typeFieldName = (&quot;\&quot;&quot; + JSON.DEFAULT_TYPE_KEY + &quot;\&quot;:\&quot;&quot;).toCharArray();</span>

    public final int scanType(String type) {
<span class="fc" id="L1125">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1127" title="All 2 branches covered.">        if (!charArrayCompare(typeFieldName)) {</span>
<span class="fc" id="L1128">            return NOT_MATCH_NAME;</span>
        }

<span class="fc" id="L1131">        int bpLocal = this.bp + typeFieldName.length;</span>

<span class="fc" id="L1133">        final int typeLength = type.length();</span>
<span class="fc bfc" id="L1134" title="All 2 branches covered.">        for (int i = 0; i &lt; typeLength; ++i) {</span>
<span class="fc bfc" id="L1135" title="All 2 branches covered.">            if (type.charAt(i) != charAt(bpLocal + i)) {</span>
<span class="fc" id="L1136">                return NOT_MATCH;</span>
            }
        }
<span class="fc" id="L1139">        bpLocal += typeLength;</span>
<span class="fc bfc" id="L1140" title="All 2 branches covered.">        if (charAt(bpLocal) != '&quot;') {</span>
<span class="fc" id="L1141">            return NOT_MATCH;</span>
        }

<span class="fc" id="L1144">        this.ch = charAt(++bpLocal);</span>

<span class="fc bfc" id="L1146" title="All 2 branches covered.">        if (ch == ',') {</span>
<span class="fc" id="L1147">            this.ch = charAt(++bpLocal);</span>
<span class="fc" id="L1148">            this.bp = bpLocal;</span>
<span class="fc" id="L1149">            token = JSONToken.COMMA;</span>
<span class="fc" id="L1150">            return VALUE;</span>
<span class="pc bpc" id="L1151" title="1 of 2 branches missed.">        } else if (ch == '}') {</span>
<span class="fc" id="L1152">            ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1153" title="All 2 branches covered.">            if (ch == ',') {</span>
<span class="fc" id="L1154">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1155">                this.ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1156" title="All 2 branches covered.">            } else if (ch == ']') {</span>
<span class="fc" id="L1157">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1158">                this.ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1159" title="All 2 branches covered.">            } else if (ch == '}') {</span>
<span class="fc" id="L1160">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1161">                this.ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1162" title="All 2 branches covered.">            } else if (ch == EOI) {</span>
<span class="fc" id="L1163">                token = JSONToken.EOF;</span>
            } else {
<span class="fc" id="L1165">                return NOT_MATCH;</span>
            }
<span class="fc" id="L1167">            matchStat = END;</span>
        }

<span class="fc" id="L1170">        this.bp = bpLocal;</span>
<span class="fc" id="L1171">        return matchStat;</span>
    }

    public final boolean matchField(char[] fieldName) {
        for (;;) {
<span class="fc bfc" id="L1176" title="All 2 branches covered.">            if (!charArrayCompare(fieldName)) {</span>
<span class="fc bfc" id="L1177" title="All 2 branches covered.">                if (isWhitespace(ch)) {</span>
<span class="fc" id="L1178">                    next();</span>
<span class="fc" id="L1179">                    continue;</span>
                }
<span class="fc" id="L1181">                return false;</span>
            } else {
                break;
            }
        }

<span class="fc" id="L1187">        bp = bp + fieldName.length;</span>
<span class="fc" id="L1188">        ch = charAt(bp);</span>

<span class="fc bfc" id="L1190" title="All 2 branches covered.">        if (ch == '{') {</span>
<span class="fc" id="L1191">            next();</span>
<span class="fc" id="L1192">            token = JSONToken.LBRACE;</span>
<span class="fc bfc" id="L1193" title="All 2 branches covered.">        } else if (ch == '[') {</span>
<span class="fc" id="L1194">            next();</span>
<span class="fc" id="L1195">            token = JSONToken.LBRACKET;</span>
<span class="pc bpc" id="L1196" title="3 of 8 branches missed.">        } else if (ch == 'S' &amp;&amp; charAt(bp + 1) == 'e' &amp;&amp; charAt(bp + 2) == 't' &amp;&amp; charAt(bp + 3) == '[') {</span>
<span class="fc" id="L1197">            bp += 3;</span>
<span class="fc" id="L1198">            ch = charAt(bp);</span>
<span class="fc" id="L1199">            token = JSONToken.SET;</span>
        } else {
<span class="fc" id="L1201">            nextToken();</span>
        }

<span class="fc" id="L1204">        return true;</span>
    }

    public int matchField(long fieldNameHash) {
<span class="nc" id="L1208">        throw new UnsupportedOperationException();</span>
    }

    public boolean seekArrayToItem(int index) {
<span class="nc" id="L1212">        throw new UnsupportedOperationException();</span>
    }

    public int seekObjectToField(long fieldNameHash, boolean deepScan) {
<span class="nc" id="L1216">        throw new UnsupportedOperationException();</span>
    }

    public int seekObjectToField(long[] fieldNameHash) {
<span class="nc" id="L1220">        throw new UnsupportedOperationException();</span>
    }

    public int seekObjectToFieldDeepScan(long fieldNameHash) {
<span class="nc" id="L1224">        throw new UnsupportedOperationException();</span>
    }

    public void skipObject() {
<span class="nc" id="L1228">        throw new UnsupportedOperationException();</span>
    }

    public void skipObject(boolean valid) {
<span class="nc" id="L1232">        throw new UnsupportedOperationException();</span>
    }

    public void skipArray() {
<span class="nc" id="L1236">        throw new UnsupportedOperationException();</span>
    }

    public abstract int indexOf(char ch, int startIndex);

    public abstract String addSymbol(int offset, int len, int hash, final SymbolTable symbolTable);

    public String scanFieldString(char[] fieldName) {
<span class="fc" id="L1244">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1246" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1247">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1248">            return stringDefaultValue();</span>
        }

        // int index = bp + fieldName.length;

<span class="fc" id="L1253">        int offset = fieldName.length;</span>
<span class="fc" id="L1254">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1256" title="All 2 branches covered.">        if (chLocal != '&quot;') {</span>
<span class="fc" id="L1257">            matchStat = NOT_MATCH;</span>

<span class="fc" id="L1259">            return stringDefaultValue();</span>
        }

        final String strVal;
        {
<span class="fc" id="L1264">            int startIndex = bp + fieldName.length + 1;</span>
<span class="fc" id="L1265">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="fc bfc" id="L1266" title="All 2 branches covered.">            if (endIndex == -1) {</span>
<span class="fc" id="L1267">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L1270">            int startIndex2 = bp + fieldName.length + 1; // must re compute</span>
<span class="fc" id="L1271">            String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="fc bfc" id="L1272" title="All 2 branches covered.">            if (stringVal.indexOf('\\') != -1) {</span>
                for (;;) {
<span class="fc" id="L1274">                    int slashCount = 0;</span>
<span class="pc bpc" id="L1275" title="1 of 2 branches missed.">                    for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="fc bfc" id="L1276" title="All 2 branches covered.">                        if (charAt(i) == '\\') {</span>
<span class="fc" id="L1277">                            slashCount++;</span>
                        } else {
                            break;
                        }
                    }
<span class="fc bfc" id="L1282" title="All 2 branches covered.">                    if (slashCount % 2 == 0) {</span>
<span class="fc" id="L1283">                        break;</span>
                    }
<span class="fc" id="L1285">                    endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="fc" id="L1286">                }</span>

<span class="fc" id="L1288">                int chars_len = endIndex - (bp + fieldName.length + 1);</span>
<span class="fc" id="L1289">                char[] chars = sub_chars( bp + fieldName.length + 1, chars_len);</span>

<span class="fc" id="L1291">                stringVal = readString(chars, chars_len);</span>
            }

<span class="fc" id="L1294">            offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="fc" id="L1295">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1296">            strVal = stringVal;</span>
        }

<span class="fc bfc" id="L1299" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L1300">            bp += offset;</span>
<span class="fc" id="L1301">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1302">            matchStat = VALUE;</span>
<span class="fc" id="L1303">            return strVal;</span>
        }

<span class="pc bpc" id="L1306" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L1307">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1308" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1309">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1310">                bp += offset;</span>
<span class="fc" id="L1311">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1312" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1313">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1314">                bp += offset;</span>
<span class="fc" id="L1315">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1316" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L1317">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1318">                bp += offset;</span>
<span class="fc" id="L1319">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1320" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1321">                token = JSONToken.EOF;</span>
<span class="fc" id="L1322">                bp += (offset - 1);</span>
<span class="fc" id="L1323">                ch = EOI;</span>
            } else {
<span class="fc" id="L1325">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1326">                return stringDefaultValue();</span>
            }
<span class="fc" id="L1328">            matchStat = END;</span>
        } else {
<span class="nc" id="L1330">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L1331">            return stringDefaultValue();</span>
        }

<span class="fc" id="L1334">        return strVal;</span>
    }

    public String scanString(char expectNextChar) {
<span class="fc" id="L1338">        matchStat = UNKNOWN;</span>

<span class="fc" id="L1340">        int offset = 0;</span>
<span class="fc" id="L1341">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1343" title="All 2 branches covered.">        if (chLocal == 'n') {</span>
<span class="fc bfc" id="L1344" title="All 6 branches covered.">            if (charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1345">                offset += 3;</span>
<span class="fc" id="L1346">                chLocal = charAt(bp + (offset++));</span>
            } else {
<span class="fc" id="L1348">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1349">                return null;</span>
            }

<span class="fc bfc" id="L1352" title="All 2 branches covered.">            if (chLocal == expectNextChar) {</span>
<span class="fc" id="L1353">                bp += offset;</span>
<span class="fc" id="L1354">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L1355">                matchStat = VALUE;</span>
<span class="fc" id="L1356">                return null;</span>
            } else {
<span class="fc" id="L1358">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1359">                return null;</span>
            }
        }

        final String strVal;
        for (;;) {
<span class="fc bfc" id="L1365" title="All 2 branches covered.">            if (chLocal == '&quot;') {</span>
<span class="fc" id="L1366">                int startIndex = bp + offset;</span>
<span class="fc" id="L1367">                int endIndex = indexOf('&quot;', startIndex);</span>
<span class="fc bfc" id="L1368" title="All 2 branches covered.">                if (endIndex == -1) {</span>
<span class="fc" id="L1369">                    throw new JSONException(&quot;unclosed str&quot;);</span>
                }

<span class="fc" id="L1372">                String stringVal = subString(bp + offset, endIndex - startIndex);</span>
<span class="fc bfc" id="L1373" title="All 2 branches covered.">                if (stringVal.indexOf('\\') != -1) {</span>
                    for (; ; ) {
<span class="fc" id="L1375">                        int slashCount = 0;</span>
<span class="pc bpc" id="L1376" title="1 of 2 branches missed.">                        for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="fc bfc" id="L1377" title="All 2 branches covered.">                            if (charAt(i) == '\\') {</span>
<span class="fc" id="L1378">                                slashCount++;</span>
                            } else {
                                break;
                            }
                        }
<span class="fc bfc" id="L1383" title="All 2 branches covered.">                        if (slashCount % 2 == 0) {</span>
<span class="fc" id="L1384">                            break;</span>
                        }
<span class="fc" id="L1386">                        endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="fc" id="L1387">                    }</span>

<span class="fc" id="L1389">                    int chars_len = endIndex - startIndex;</span>
<span class="fc" id="L1390">                    char[] chars = sub_chars(bp + 1, chars_len);</span>

<span class="fc" id="L1392">                    stringVal = readString(chars, chars_len);</span>
                }

<span class="fc" id="L1395">                offset += (endIndex - startIndex + 1);</span>
<span class="fc" id="L1396">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1397">                strVal = stringVal;</span>
<span class="fc" id="L1398">                break;</span>
<span class="fc bfc" id="L1399" title="All 2 branches covered.">            } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L1400">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1401">                continue;</span>
            } else {
<span class="fc" id="L1403">                matchStat = NOT_MATCH;</span>

<span class="fc" id="L1405">                return stringDefaultValue();</span>
            }
        }

        for (;;) {
<span class="fc bfc" id="L1410" title="All 2 branches covered.">            if (chLocal == expectNextChar) {</span>
<span class="fc" id="L1411">                bp += offset;</span>
<span class="fc" id="L1412">                this.ch = charAt(bp);</span>
<span class="fc" id="L1413">                matchStat = VALUE;</span>
<span class="fc" id="L1414">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1415">                return strVal;</span>
<span class="pc bpc" id="L1416" title="1 of 2 branches missed.">            } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L1417">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L1418">                continue;</span>
            } else {
<span class="fc bfc" id="L1420" title="All 2 branches covered.">                if (chLocal == ']') {</span>
<span class="fc" id="L1421">                    bp += offset;</span>
<span class="fc" id="L1422">                    this.ch = charAt(bp);</span>
<span class="fc" id="L1423">                    matchStat = NOT_MATCH;</span>
                }
<span class="fc" id="L1425">                return strVal;</span>
            }
        }
    }

    public long scanFieldSymbol(char[] fieldName) {
<span class="nc" id="L1431">        matchStat = UNKNOWN;</span>

<span class="nc bnc" id="L1433" title="All 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L1434">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L1435">            return 0;</span>
        }

<span class="nc" id="L1438">        int offset = fieldName.length;</span>
<span class="nc" id="L1439">        char chLocal = charAt(bp + (offset++));</span>

<span class="nc bnc" id="L1441" title="All 2 branches missed.">        if (chLocal != '&quot;') {</span>
<span class="nc" id="L1442">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L1443">            return 0;</span>
        }

<span class="nc" id="L1446">        long hash = fnv1a_64_magic_hashcode;</span>
        for (;;) {
<span class="nc" id="L1448">            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L1449" title="All 2 branches missed.">            if (chLocal == '\&quot;') {</span>
<span class="nc" id="L1450">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L1451">                break;</span>
            }

<span class="nc" id="L1454">            hash ^= chLocal;</span>
<span class="nc" id="L1455">            hash *= fnv1a_64_magic_prime;</span>

<span class="nc bnc" id="L1457" title="All 2 branches missed.">            if (chLocal == '\\') {</span>
<span class="nc" id="L1458">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1459">                return 0;</span>
            }
        }

<span class="nc bnc" id="L1463" title="All 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L1464">            bp += offset;</span>
<span class="nc" id="L1465">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L1466">            matchStat = VALUE;</span>
<span class="nc" id="L1467">            return hash;</span>
        }

<span class="nc bnc" id="L1470" title="All 2 branches missed.">        if (chLocal == '}') {</span>
<span class="nc" id="L1471">            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L1472" title="All 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L1473">                token = JSONToken.COMMA;</span>
<span class="nc" id="L1474">                bp += offset;</span>
<span class="nc" id="L1475">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L1476" title="All 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L1477">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L1478">                bp += offset;</span>
<span class="nc" id="L1479">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L1480" title="All 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L1481">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L1482">                bp += offset;</span>
<span class="nc" id="L1483">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L1484" title="All 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="nc" id="L1485">                token = JSONToken.EOF;</span>
<span class="nc" id="L1486">                bp += (offset - 1);</span>
<span class="nc" id="L1487">                ch = EOI;</span>
            } else {
<span class="nc" id="L1489">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1490">                return 0;</span>
            }
<span class="nc" id="L1492">            matchStat = END;</span>
        } else {
<span class="nc" id="L1494">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L1495">            return 0;</span>
        }

<span class="nc" id="L1498">        return hash;</span>
    }

    public long scanEnumSymbol(char[] fieldName) {
<span class="fc" id="L1502">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1504" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1505">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1506">            return 0;</span>
        }

<span class="fc" id="L1509">        int offset = fieldName.length;</span>
<span class="fc" id="L1510">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1512" title="All 2 branches covered.">        if (chLocal != '&quot;') {</span>
<span class="fc" id="L1513">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1514">            return 0;</span>
        }

<span class="fc" id="L1517">        long hash = fnv1a_64_magic_hashcode;</span>
        for (;;) {
<span class="fc" id="L1519">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1520" title="All 2 branches covered.">            if (chLocal == '\&quot;') {</span>
<span class="fc" id="L1521">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1522">                break;</span>
            }

<span class="fc bfc" id="L1525" title="All 4 branches covered.">            hash ^= ((chLocal &gt;= 'A' &amp;&amp; chLocal &lt;= 'Z') ? (chLocal + 32) : chLocal);</span>
<span class="fc" id="L1526">            hash *= fnv1a_64_magic_prime;</span>

<span class="fc bfc" id="L1528" title="All 2 branches covered.">            if (chLocal == '\\') {</span>
<span class="fc" id="L1529">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1530">                return 0;</span>
            }
        }

<span class="fc bfc" id="L1534" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L1535">            bp += offset;</span>
<span class="fc" id="L1536">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1537">            matchStat = VALUE;</span>
<span class="fc" id="L1538">            return hash;</span>
        }

<span class="fc bfc" id="L1541" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L1542">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1543" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1544">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1545">                bp += offset;</span>
<span class="fc" id="L1546">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1547" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1548">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1549">                bp += offset;</span>
<span class="fc" id="L1550">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1551" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L1552">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1553">                bp += offset;</span>
<span class="fc" id="L1554">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1555" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1556">                token = JSONToken.EOF;</span>
<span class="fc" id="L1557">                bp += (offset - 1);</span>
<span class="fc" id="L1558">                ch = EOI;</span>
            } else {
<span class="fc" id="L1560">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1561">                return 0;</span>
            }
<span class="fc" id="L1563">            matchStat = END;</span>
        } else {
<span class="fc" id="L1565">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1566">            return 0;</span>
        }

<span class="fc" id="L1569">        return hash;</span>
    }

    @SuppressWarnings({ &quot;unchecked&quot;, &quot;rawtypes&quot; })
    public Enum&lt;?&gt; scanEnum(Class&lt;?&gt; enumClass, final SymbolTable symbolTable, char serperator) {
<span class="fc" id="L1574">        String name = scanSymbolWithSeperator(symbolTable, serperator);</span>
<span class="fc bfc" id="L1575" title="All 2 branches covered.">        if (name == null) {</span>
<span class="fc" id="L1576">            return null;</span>
        }
<span class="fc" id="L1578">        return Enum.valueOf((Class&lt;? extends Enum&gt;) enumClass, name);</span>
    }

    public String scanSymbolWithSeperator(final SymbolTable symbolTable, char serperator) {
<span class="fc" id="L1582">        matchStat = UNKNOWN;</span>

<span class="fc" id="L1584">        int offset = 0;</span>
<span class="fc" id="L1585">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1587" title="All 2 branches covered.">        if (chLocal == 'n') {</span>
<span class="fc bfc" id="L1588" title="All 6 branches covered.">            if (charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1589">                offset += 3;</span>
<span class="fc" id="L1590">                chLocal = charAt(bp + (offset++));</span>
            } else {
<span class="fc" id="L1592">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1593">                return null;</span>
            }

<span class="fc bfc" id="L1596" title="All 2 branches covered.">            if (chLocal == serperator) {</span>
<span class="fc" id="L1597">                bp += offset;</span>
<span class="fc" id="L1598">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L1599">                matchStat = VALUE;</span>
<span class="fc" id="L1600">                return null;</span>
            } else {
<span class="fc" id="L1602">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1603">                return null;</span>
            }
        }

<span class="fc bfc" id="L1607" title="All 2 branches covered.">        if (chLocal != '&quot;') {</span>
<span class="fc" id="L1608">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1609">            return null;</span>
        }

        String strVal;
        // int start = index;
<span class="fc" id="L1614">        int hash = 0;</span>
        for (;;) {
<span class="fc" id="L1616">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1617" title="All 2 branches covered.">            if (chLocal == '\&quot;') {</span>
                // bp = index;
                // this.ch = chLocal = charAt(bp);
<span class="fc" id="L1620">                int start = bp + 0 + 1;</span>
<span class="fc" id="L1621">                int len = bp + offset - start - 1;</span>
<span class="fc" id="L1622">                strVal = addSymbol(start, len, hash, symbolTable);</span>
<span class="fc" id="L1623">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1624">                break;</span>
            }

<span class="fc" id="L1627">            hash = 31 * hash + chLocal;</span>

<span class="pc bpc" id="L1629" title="1 of 2 branches missed.">            if (chLocal == '\\') {</span>
<span class="nc" id="L1630">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1631">                return null;</span>
            }
        }

        for (;;) {
<span class="fc bfc" id="L1636" title="All 2 branches covered.">            if (chLocal == serperator) {</span>
<span class="fc" id="L1637">                bp += offset;</span>
<span class="fc" id="L1638">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L1639">                matchStat = VALUE;</span>
<span class="fc" id="L1640">                return strVal;</span>
            } else {
<span class="pc bpc" id="L1642" title="1 of 2 branches missed.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L1643">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1644">                    continue;</span>
                }

<span class="nc" id="L1647">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1648">                return strVal;</span>
            }
        }
    }

    public Collection&lt;String&gt; newCollectionByType(Class&lt;?&gt; type){
<span class="fc bfc" id="L1654" title="All 2 branches covered.">        if (type.isAssignableFrom(HashSet.class)) {</span>
<span class="fc" id="L1655">            return new HashSet&lt;String&gt;();</span>
<span class="fc bfc" id="L1656" title="All 2 branches covered.">        } else if (type.isAssignableFrom(ArrayList.class)) {</span>
<span class="fc" id="L1657">            return new ArrayList&lt;String&gt;();</span>
<span class="fc bfc" id="L1658" title="All 2 branches covered.">        } else if (type.isAssignableFrom(LinkedList.class)) {</span>
<span class="fc" id="L1659">            return new LinkedList&lt;String&gt;();</span>
        } else {
            try {
<span class="fc" id="L1662">                return (Collection&lt;String&gt;) type.newInstance();</span>
<span class="fc" id="L1663">            } catch (Exception e) {</span>
<span class="fc" id="L1664">                throw new JSONException(e.getMessage(), e);</span>
            }
        }
    }

    @SuppressWarnings(&quot;unchecked&quot;)
    public Collection&lt;String&gt; scanFieldStringArray(char[] fieldName, Class&lt;?&gt; type) {
<span class="fc" id="L1671">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1673" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1674">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1675">            return null;</span>
        }

<span class="fc" id="L1678">        Collection&lt;String&gt; list = newCollectionByType(type);</span>

//        if (type.isAssignableFrom(HashSet.class)) {
//            list = new HashSet&lt;String&gt;();
//        } else if (type.isAssignableFrom(ArrayList.class)) {
//            list = new ArrayList&lt;String&gt;();
//        } else {
//            try {
//                list = (Collection&lt;String&gt;) type.newInstance();
//            } catch (Exception e) {
//                throw new JSONException(e.getMessage(), e);
//            }
//        }

        // int index = bp + fieldName.length;

<span class="fc" id="L1694">        int offset = fieldName.length;</span>
<span class="fc" id="L1695">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1697" title="All 2 branches covered.">        if (chLocal != '[') {</span>
<span class="fc" id="L1698">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1699">            return null;</span>
        }

<span class="fc" id="L1702">        chLocal = charAt(bp + (offset++));</span>

        for (;;) {
            // int start = index;
<span class="fc bfc" id="L1706" title="All 2 branches covered.">            if (chLocal == '&quot;') {</span>
<span class="fc" id="L1707">                int startIndex = bp + offset;</span>
<span class="fc" id="L1708">                int endIndex = indexOf('&quot;', startIndex);</span>
<span class="fc bfc" id="L1709" title="All 2 branches covered.">                if (endIndex == -1) {</span>
<span class="fc" id="L1710">                    throw new JSONException(&quot;unclosed str&quot;);</span>
                }

<span class="fc" id="L1713">                int startIndex2 = bp + offset; // must re compute</span>
<span class="fc" id="L1714">                String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="fc bfc" id="L1715" title="All 2 branches covered.">                if (stringVal.indexOf('\\') != -1) {</span>
                    for (;;) {
<span class="fc" id="L1717">                        int slashCount = 0;</span>
<span class="pc bpc" id="L1718" title="1 of 2 branches missed.">                        for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="fc bfc" id="L1719" title="All 2 branches covered.">                            if (charAt(i) == '\\') {</span>
<span class="fc" id="L1720">                                slashCount++;</span>
                            } else {
                                break;
                            }
                        }
<span class="fc bfc" id="L1725" title="All 2 branches covered.">                        if (slashCount % 2 == 0) {</span>
<span class="fc" id="L1726">                            break;</span>
                        }
<span class="fc" id="L1728">                        endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="fc" id="L1729">                    }</span>

<span class="fc" id="L1731">                    int chars_len = endIndex - (bp + offset);</span>
<span class="fc" id="L1732">                    char[] chars = sub_chars(bp + offset, chars_len);</span>

<span class="fc" id="L1734">                    stringVal = readString(chars, chars_len);</span>
                }

<span class="fc" id="L1737">                offset += (endIndex - (bp + offset) + 1);</span>
<span class="fc" id="L1738">                chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L1740">                list.add(stringVal);</span>
<span class="fc bfc" id="L1741" title="All 2 branches covered.">            } else if (chLocal == 'n' //</span>
<span class="fc bfc" id="L1742" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset) == 'u' //</span>
<span class="fc bfc" id="L1743" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 1) == 'l' //</span>
<span class="fc bfc" id="L1744" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1745">                offset += 3;</span>
<span class="fc" id="L1746">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1747">                list.add(null);</span>
<span class="fc bfc" id="L1748" title="All 4 branches covered.">            } else if (chLocal == ']' &amp;&amp; list.size() == 0) {</span>
<span class="fc" id="L1749">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1750">                break;</span>
            } else {
<span class="fc" id="L1752">                throw new JSONException(&quot;illega str&quot;);</span>
            }

<span class="fc bfc" id="L1755" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1756">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1757">                continue;</span>
            }

<span class="fc bfc" id="L1760" title="All 2 branches covered.">            if (chLocal == ']') {</span>
<span class="fc" id="L1761">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1762">                break;</span>
            }

<span class="fc" id="L1765">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1766">            return null;</span>
        }

<span class="pc bpc" id="L1769" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L1770">            bp += offset;</span>
<span class="nc" id="L1771">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L1772">            matchStat = VALUE;</span>
<span class="nc" id="L1773">            return list;</span>
        }

<span class="fc bfc" id="L1776" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L1777">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1778" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1779">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1780">                bp += offset;</span>
<span class="fc" id="L1781">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1782" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1783">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1784">                bp += offset;</span>
<span class="fc" id="L1785">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1786" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L1787">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1788">                bp += offset;</span>
<span class="fc" id="L1789">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1790" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1791">                bp += (offset - 1);</span>
<span class="fc" id="L1792">                token = JSONToken.EOF;</span>
<span class="fc" id="L1793">                this.ch = EOI;</span>
            } else {
<span class="fc" id="L1795">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1796">                return null;</span>
            }
<span class="fc" id="L1798">            matchStat = END;</span>
        } else {
<span class="fc" id="L1800">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1801">            return null;</span>
        }

<span class="fc" id="L1804">        return list;</span>
    }

    public void scanStringArray(Collection&lt;String&gt; list, char seperator) {
<span class="fc" id="L1808">        matchStat = UNKNOWN;</span>

<span class="fc" id="L1810">        int offset = 0;</span>
<span class="fc" id="L1811">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1813" title="All 2 branches covered.">        if (chLocal == 'n'</span>
<span class="pc bpc" id="L1814" title="1 of 2 branches missed.">                &amp;&amp; charAt(bp + offset) == 'u'</span>
<span class="pc bpc" id="L1815" title="1 of 2 branches missed.">                &amp;&amp; charAt(bp + offset + 1) == 'l'</span>
<span class="pc bpc" id="L1816" title="1 of 2 branches missed.">                &amp;&amp; charAt(bp + offset + 2) == 'l'</span>
<span class="pc bpc" id="L1817" title="1 of 2 branches missed.">                &amp;&amp; charAt(bp + offset + 3) == seperator</span>
        ) {
<span class="fc" id="L1819">            bp += 5;</span>
<span class="fc" id="L1820">            ch = charAt(bp);</span>
<span class="fc" id="L1821">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L1822">            return;</span>
        }

<span class="pc bpc" id="L1825" title="1 of 2 branches missed.">        if (chLocal != '[') {</span>
<span class="nc" id="L1826">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L1827">            return;</span>
        }

<span class="fc" id="L1830">        chLocal = charAt(bp + (offset++));</span>

        for (;;) {
<span class="fc bfc" id="L1833" title="All 2 branches covered.">            if (chLocal == 'n' //</span>
<span class="pc bpc" id="L1834" title="1 of 2 branches missed.">                    &amp;&amp; charAt(bp + offset) == 'u' //</span>
<span class="pc bpc" id="L1835" title="1 of 2 branches missed.">                    &amp;&amp; charAt(bp + offset + 1) == 'l' //</span>
<span class="pc bpc" id="L1836" title="1 of 2 branches missed.">                    &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1837">                offset += 3;</span>
<span class="fc" id="L1838">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1839">                list.add(null);</span>
<span class="pc bpc" id="L1840" title="1 of 4 branches missed.">            } else if (chLocal == ']' &amp;&amp; list.size() == 0) {</span>
<span class="fc" id="L1841">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1842">                break;</span>
<span class="pc bpc" id="L1843" title="1 of 2 branches missed.">            } else if (chLocal != '&quot;') {</span>
<span class="nc" id="L1844">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1845">                return;</span>
            } else {
<span class="fc" id="L1847">                int startIndex = bp + offset;</span>
<span class="fc" id="L1848">                int endIndex = indexOf('&quot;', startIndex);</span>
<span class="pc bpc" id="L1849" title="1 of 2 branches missed.">                if (endIndex == -1) {</span>
<span class="nc" id="L1850">                    throw new JSONException(&quot;unclosed str&quot;);</span>
                }

<span class="fc" id="L1853">                String stringVal = subString(bp + offset, endIndex - startIndex);</span>
<span class="pc bpc" id="L1854" title="1 of 2 branches missed.">                if (stringVal.indexOf('\\') != -1) {</span>
                    for (;;) {
<span class="nc" id="L1856">                        int slashCount = 0;</span>
<span class="nc bnc" id="L1857" title="All 2 branches missed.">                        for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="nc bnc" id="L1858" title="All 2 branches missed.">                            if (charAt(i) == '\\') {</span>
<span class="nc" id="L1859">                                slashCount++;</span>
                            } else {
                                break;
                            }
                        }
<span class="nc bnc" id="L1864" title="All 2 branches missed.">                        if (slashCount % 2 == 0) {</span>
<span class="nc" id="L1865">                            break;</span>
                        }
<span class="nc" id="L1867">                        endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="nc" id="L1868">                    }</span>

<span class="nc" id="L1870">                    int chars_len = endIndex - startIndex;</span>
<span class="nc" id="L1871">                    char[] chars = sub_chars(bp + offset, chars_len);</span>

<span class="nc" id="L1873">                    stringVal = readString(chars, chars_len);</span>
                }

<span class="fc" id="L1876">                offset += (endIndex - (bp + offset) + 1);</span>
<span class="fc" id="L1877">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1878">                list.add(stringVal);</span>
            }

<span class="fc bfc" id="L1881" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1882">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1883">                continue;</span>
            }

<span class="pc bpc" id="L1886" title="1 of 2 branches missed.">            if (chLocal == ']') {</span>
<span class="fc" id="L1887">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1888">                break;</span>
            }

<span class="nc" id="L1891">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L1892">            return;</span>
        }

<span class="pc bpc" id="L1895" title="1 of 2 branches missed.">        if (chLocal == seperator) {</span>
<span class="fc" id="L1896">            bp += offset;</span>
<span class="fc" id="L1897">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1898">            matchStat = VALUE;</span>
<span class="fc" id="L1899">            return;</span>
        } else {
<span class="nc" id="L1901">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L1902">            return;</span>
        }
    }

    public int scanFieldInt(char[] fieldName) {
<span class="fc" id="L1907">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1909" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1910">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1911">            return 0;</span>
        }

<span class="fc" id="L1914">        int offset = fieldName.length;</span>
<span class="fc" id="L1915">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1917" title="All 2 branches covered.">        final boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L1918" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L1919">            chLocal = charAt(bp + (offset++));</span>
        }

        int value;
<span class="pc bpc" id="L1923" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L1924">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L1926">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1927" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L1928">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L1929" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L1930">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L1931">                    return 0;</span>
                } else {
                    break;
                }
            }
<span class="fc bfc" id="L1936" title="All 4 branches covered.">            if (value &lt; 0 //</span>
                    || offset &gt; 11 + 3 + fieldName.length) {
<span class="pc bpc" id="L1938" title="1 of 6 branches missed.">                if (value != Integer.MIN_VALUE //</span>
                        || offset != 17 //
                        || !negative) {
<span class="fc" id="L1941">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L1942">                    return 0;</span>
                }
            }
        } else {
<span class="fc" id="L1946">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1947">            return 0;</span>
        }

<span class="fc bfc" id="L1950" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L1951">            bp += offset;</span>
<span class="fc" id="L1952">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1953">            matchStat = VALUE;</span>
<span class="fc" id="L1954">            token = JSONToken.COMMA;</span>
<span class="fc bfc" id="L1955" title="All 2 branches covered.">            return negative ? -value : value;</span>
        }

<span class="fc bfc" id="L1958" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L1959">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1960" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1961">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1962">                bp += offset;</span>
<span class="fc" id="L1963">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1964" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1965">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1966">                bp += offset;</span>
<span class="fc" id="L1967">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1968" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L1969">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1970">                bp += offset;</span>
<span class="fc" id="L1971">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1972" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1973">                token = JSONToken.EOF;</span>
<span class="fc" id="L1974">                bp += (offset - 1);</span>
<span class="fc" id="L1975">                ch = EOI;</span>
            } else {
<span class="fc" id="L1977">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1978">                return 0;</span>
            }
<span class="fc" id="L1980">            matchStat = END;</span>
        } else {
<span class="fc" id="L1982">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1983">            return 0;</span>
        }

<span class="fc bfc" id="L1986" title="All 2 branches covered.">        return negative ? -value : value;</span>
    }

    public final int[] scanFieldIntArray(char[] fieldName) {
<span class="fc" id="L1990">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L1992" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L1993">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L1994">            return null;</span>
        }

<span class="fc" id="L1997">        int offset = fieldName.length;</span>
<span class="fc" id="L1998">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L2000" title="All 2 branches covered.">        if (chLocal != '[') {</span>
<span class="fc" id="L2001">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L2002">            return null;</span>
        }
<span class="fc" id="L2004">        chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L2006">        int[] array = new int[16];</span>
<span class="fc" id="L2007">        int arrayIndex = 0;</span>

<span class="pc bpc" id="L2009" title="1 of 2 branches missed.">        if (chLocal == ']') {</span>
<span class="nc" id="L2010">            chLocal = charAt(bp + (offset++));</span>
        } else {
            for (;;) {
<span class="fc" id="L2013">                boolean nagative = false;</span>
<span class="pc bpc" id="L2014" title="1 of 2 branches missed.">                if (chLocal == '-') {</span>
<span class="nc" id="L2015">                    chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L2016">                    nagative = true;</span>
                }
<span class="pc bpc" id="L2018" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2019">                    int value = chLocal - '0';</span>
                    for (; ; ) {
<span class="fc" id="L2021">                        chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L2023" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2024">                            value = value * 10 + (chLocal - '0');</span>
                        } else {
                            break;
                        }
                    }

<span class="pc bpc" id="L2030" title="1 of 2 branches missed.">                    if (arrayIndex &gt;= array.length) {</span>
<span class="nc" id="L2031">                        int[] tmp = new int[array.length * 3 / 2];</span>
<span class="nc" id="L2032">                        System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L2033">                        array = tmp;</span>
                    }
<span class="pc bpc" id="L2035" title="1 of 2 branches missed.">                    array[arrayIndex++] = nagative ? -value : value;</span>

<span class="fc bfc" id="L2037" title="All 2 branches covered.">                    if (chLocal == ',') {</span>
<span class="fc" id="L2038">                        chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2039" title="1 of 2 branches missed.">                    } else if (chLocal == ']') {</span>
<span class="fc" id="L2040">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2041">                        break;</span>
                    }
<span class="fc" id="L2043">                } else {</span>
<span class="fc" id="L2044">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2045">                    return null;</span>
                }
<span class="fc" id="L2047">            }</span>
        }


<span class="pc bpc" id="L2051" title="1 of 2 branches missed.">        if (arrayIndex != array.length) {</span>
<span class="fc" id="L2052">            int[] tmp = new int[arrayIndex];</span>
<span class="fc" id="L2053">            System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="fc" id="L2054">            array = tmp;</span>
        }

<span class="pc bpc" id="L2057" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L2058">            bp += (offset - 1);</span>
<span class="nc" id="L2059">            this.next();</span>
<span class="nc" id="L2060">            matchStat = VALUE;</span>
<span class="nc" id="L2061">            token = JSONToken.COMMA;</span>
<span class="nc" id="L2062">            return array;</span>
        }

<span class="pc bpc" id="L2065" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L2066">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2067" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L2068">                token = JSONToken.COMMA;</span>
<span class="fc" id="L2069">                bp += (offset - 1);</span>
<span class="fc" id="L2070">                this.next();</span>
<span class="fc bfc" id="L2071" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L2072">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2073">                bp += (offset - 1);</span>
<span class="fc" id="L2074">                this.next();</span>
<span class="pc bpc" id="L2075" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L2076">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L2077">                bp += (offset - 1);</span>
<span class="nc" id="L2078">                this.next();</span>
<span class="pc bpc" id="L2079" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L2080">                bp += (offset - 1);</span>
<span class="fc" id="L2081">                token = JSONToken.EOF;</span>
<span class="fc" id="L2082">                ch = EOI;</span>
            } else {
<span class="nc" id="L2084">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L2085">                return null;</span>
            }
<span class="fc" id="L2087">            matchStat = END;</span>
        } else {
<span class="nc" id="L2089">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2090">            return null;</span>
        }

<span class="fc" id="L2093">        return array;</span>
    }

    public boolean scanBoolean(char expectNext) {
<span class="fc" id="L2097">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2099">        int offset = 0;</span>
<span class="fc" id="L2100">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L2102">        boolean value = false;</span>
<span class="fc bfc" id="L2103" title="All 2 branches covered.">        if (chLocal == 't') {</span>
<span class="fc bfc" id="L2104" title="All 2 branches covered.">            if (charAt(bp + offset) == 'r' //</span>
<span class="fc bfc" id="L2105" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 1) == 'u' //</span>
<span class="fc bfc" id="L2106" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 2) == 'e') {</span>
<span class="fc" id="L2107">                offset += 3;</span>
<span class="fc" id="L2108">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2109">                value = true;</span>
            } else {
<span class="fc" id="L2111">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2112">                return false;</span>
            }
<span class="fc bfc" id="L2114" title="All 2 branches covered.">        } else if (chLocal == 'f') {</span>
<span class="fc bfc" id="L2115" title="All 2 branches covered.">            if (charAt(bp + offset) == 'a' //</span>
<span class="fc bfc" id="L2116" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 1) == 'l' //</span>
<span class="fc bfc" id="L2117" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 2) == 's' //</span>
<span class="fc bfc" id="L2118" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 3) == 'e') {</span>
<span class="fc" id="L2119">                offset += 4;</span>
<span class="fc" id="L2120">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2121">                value = false;</span>
            } else {
<span class="fc" id="L2123">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2124">                return false;</span>
            }
<span class="fc bfc" id="L2126" title="All 2 branches covered.">        } else if (chLocal == '1') {</span>
<span class="fc" id="L2127">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2128">            value = true;</span>
<span class="pc bpc" id="L2129" title="1 of 2 branches missed.">        } else if (chLocal == '0') {</span>
<span class="fc" id="L2130">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2131">            value = false;</span>
        }

        for (;;) {
<span class="fc bfc" id="L2135" title="All 2 branches covered.">            if (chLocal == expectNext) {</span>
<span class="fc" id="L2136">                bp += offset;</span>
<span class="fc" id="L2137">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L2138">                matchStat = VALUE;</span>
<span class="fc" id="L2139">                return value;</span>
            } else {
<span class="fc bfc" id="L2141" title="All 2 branches covered.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2142">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2143">                    continue;</span>
                }
<span class="fc" id="L2145">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2146">                return value;</span>
            }
        }
    }

    public int scanInt(char expectNext) {
<span class="fc" id="L2152">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2154">        int offset = 0;</span>
<span class="fc" id="L2155">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L2157" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2158" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2159">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2162" title="All 2 branches covered.">        final boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2163" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2164">            chLocal = charAt(bp + (offset++));</span>
        }

        int value;
<span class="fc bfc" id="L2168" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2169">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L2171">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2172" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2173">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L2174" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L2175">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2176">                    return 0;</span>
                } else {
                    break;
                }
            }
<span class="fc bfc" id="L2181" title="All 2 branches covered.">            if (value &lt; 0) {</span>
<span class="fc" id="L2182">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2183">                return 0;</span>
            }
<span class="pc bpc" id="L2185" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2186">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2187">            value = 0;</span>
<span class="fc" id="L2188">            offset += 3;</span>
<span class="fc" id="L2189">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2191" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2192">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2196" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2197">                    bp += offset;</span>
<span class="fc" id="L2198">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2199">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2200">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2201">                    return value;</span>
<span class="fc bfc" id="L2202" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2203">                    bp += offset;</span>
<span class="fc" id="L2204">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2205">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2206">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2207">                    return value;</span>
<span class="pc bpc" id="L2208" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2209">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2210">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2214">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2215">            return 0;</span>
        } else {
<span class="fc" id="L2217">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2218">            return 0;</span>
        }

        for (;;) {
<span class="fc bfc" id="L2222" title="All 2 branches covered.">            if (chLocal == expectNext) {</span>
<span class="fc" id="L2223">                bp += offset;</span>
<span class="fc" id="L2224">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L2225">                matchStat = VALUE;</span>
<span class="fc" id="L2226">                token = JSONToken.COMMA;</span>
<span class="fc bfc" id="L2227" title="All 2 branches covered.">                return negative ? -value : value;</span>
            } else {
<span class="fc bfc" id="L2229" title="All 2 branches covered.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2230">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2231">                    continue;</span>
                }
<span class="fc" id="L2233">                matchStat = NOT_MATCH;</span>
<span class="fc bfc" id="L2234" title="All 2 branches covered.">                return negative ? -value : value;</span>
            }
        }
    }

    public boolean scanFieldBoolean(char[] fieldName) {
<span class="fc" id="L2240">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L2242" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L2243">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L2244">            return false;</span>
        }

<span class="fc" id="L2247">        int offset = fieldName.length;</span>
<span class="fc" id="L2248">        char chLocal = charAt(bp + (offset++));</span>

        boolean value;
<span class="fc bfc" id="L2251" title="All 2 branches covered.">        if (chLocal == 't') {</span>
<span class="fc bfc" id="L2252" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'r') {</span>
<span class="fc" id="L2253">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2254">                return false;</span>
            }
<span class="fc bfc" id="L2256" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'u') {</span>
<span class="fc" id="L2257">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2258">                return false;</span>
            }
<span class="fc bfc" id="L2260" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'e') {</span>
<span class="fc" id="L2261">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2262">                return false;</span>
            }

<span class="fc" id="L2265">            value = true;</span>
<span class="fc bfc" id="L2266" title="All 2 branches covered.">        } else if (chLocal == 'f') {</span>
<span class="fc bfc" id="L2267" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'a') {</span>
<span class="fc" id="L2268">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2269">                return false;</span>
            }
<span class="fc bfc" id="L2271" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'l') {</span>
<span class="fc" id="L2272">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2273">                return false;</span>
            }
<span class="fc bfc" id="L2275" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 's') {</span>
<span class="fc" id="L2276">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2277">                return false;</span>
            }
<span class="fc bfc" id="L2279" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'e') {</span>
<span class="fc" id="L2280">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2281">                return false;</span>
            }

<span class="fc" id="L2284">            value = false;</span>
        } else {
<span class="fc" id="L2286">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2287">            return false;</span>
        }

<span class="fc" id="L2290">        chLocal = charAt(bp + offset++);</span>
<span class="fc bfc" id="L2291" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L2292">            bp += offset;</span>
<span class="fc" id="L2293">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2294">            matchStat = VALUE;</span>
<span class="fc" id="L2295">            token = JSONToken.COMMA;</span>

<span class="fc" id="L2297">            return value;</span>
        }

<span class="pc bpc" id="L2300" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L2301">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2302" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L2303">                token = JSONToken.COMMA;</span>
<span class="fc" id="L2304">                bp += offset;</span>
<span class="fc" id="L2305">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2306" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L2307">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2308">                bp += offset;</span>
<span class="fc" id="L2309">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2310" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L2311">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L2312">                bp += offset;</span>
<span class="fc" id="L2313">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2314" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L2315">                token = JSONToken.EOF;</span>
<span class="fc" id="L2316">                bp += (offset - 1);</span>
<span class="fc" id="L2317">                ch = EOI;</span>
            } else {
<span class="fc" id="L2319">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2320">                return false;</span>
            }
<span class="fc" id="L2322">            matchStat = END;</span>
        } else {
<span class="nc" id="L2324">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2325">            return false;</span>
        }

<span class="fc" id="L2328">        return value;</span>
    }

    public long scanFieldLong(char[] fieldName) {
<span class="fc" id="L2332">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L2334" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L2335">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L2336">            return 0;</span>
        }

<span class="fc" id="L2339">        int offset = fieldName.length;</span>
<span class="fc" id="L2340">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L2342">        boolean negative = false;</span>
<span class="fc bfc" id="L2343" title="All 2 branches covered.">        if (chLocal == '-') {</span>
<span class="fc" id="L2344">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2345">            negative = true;</span>
        }

        long value;
<span class="fc bfc" id="L2349" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2350">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L2352">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2353" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2354">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L2355" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L2356">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2357">                    return 0;</span>
                } else {
                    break;
                }
            }

<span class="pc bpc" id="L2363" title="2 of 8 branches missed.">            boolean valid = offset - fieldName.length &lt; 21</span>
                    &amp;&amp; (value &gt;= 0 || (value == -9223372036854775808L &amp;&amp; negative));
<span class="fc bfc" id="L2365" title="All 2 branches covered.">            if (!valid) {</span>
<span class="fc" id="L2366">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2367">                return 0;</span>
            }
<span class="fc" id="L2369">        } else {</span>
<span class="fc" id="L2370">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2371">            return 0;</span>
        }

<span class="fc bfc" id="L2374" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L2375">            bp += offset;</span>
<span class="fc" id="L2376">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2377">            matchStat = VALUE;</span>
<span class="fc" id="L2378">            token = JSONToken.COMMA;</span>
<span class="pc bpc" id="L2379" title="1 of 2 branches missed.">            return negative ? -value : value;</span>
        }

<span class="fc bfc" id="L2382" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L2383">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2384" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L2385">                token = JSONToken.COMMA;</span>
<span class="fc" id="L2386">                bp += offset;</span>
<span class="fc" id="L2387">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2388" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L2389">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2390">                bp += offset;</span>
<span class="fc" id="L2391">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2392" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L2393">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L2394">                bp += offset;</span>
<span class="fc" id="L2395">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2396" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L2397">                token = JSONToken.EOF;</span>
<span class="fc" id="L2398">                bp += (offset - 1);</span>
<span class="fc" id="L2399">                ch = EOI;</span>
            } else {
<span class="fc" id="L2401">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2402">                return 0;</span>
            }
<span class="fc" id="L2404">            matchStat = END;</span>
        } else {
<span class="fc" id="L2406">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2407">            return 0;</span>
        }

<span class="fc bfc" id="L2410" title="All 2 branches covered.">        return negative ? -value : value;</span>
    }

    public long scanLong(char expectNextChar) {
<span class="fc" id="L2414">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2416">        int offset = 0;</span>
<span class="fc" id="L2417">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2418" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2419" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2420">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2423" title="All 2 branches covered.">        final boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2424" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2425">            chLocal = charAt(bp + (offset++));</span>
        }

        long value;
<span class="fc bfc" id="L2429" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2430">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L2432">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2433" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2434">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L2435" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L2436">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2437">                    return 0;</span>
                } else {
                    break;
                }
            }
<span class="pc bpc" id="L2442" title="1 of 6 branches missed.">            boolean valid = value &gt;= 0 || (value == -9223372036854775808L &amp;&amp; negative);</span>
<span class="fc bfc" id="L2443" title="All 2 branches covered.">            if (!valid) {</span>
<span class="fc" id="L2444">                String val = subString(bp, offset - 1);</span>
<span class="fc" id="L2445">                throw new NumberFormatException(val);</span>
            }
<span class="pc bpc" id="L2447" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2448">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2449">            value = 0;</span>
<span class="fc" id="L2450">            offset += 3;</span>
<span class="fc" id="L2451">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2453" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2454">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2458" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2459">                    bp += offset;</span>
<span class="fc" id="L2460">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2461">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2462">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2463">                    return value;</span>
<span class="fc bfc" id="L2464" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2465">                    bp += offset;</span>
<span class="fc" id="L2466">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2467">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2468">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2469">                    return value;</span>
<span class="pc bpc" id="L2470" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2471">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2472">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2476">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2477">            return 0;</span>
        } else {
<span class="fc" id="L2479">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2480">            return 0;</span>
        }

<span class="fc bfc" id="L2483" title="All 2 branches covered.">        if (quote) {</span>
<span class="pc bpc" id="L2484" title="1 of 2 branches missed.">            if (chLocal != '&quot;') {</span>
<span class="nc" id="L2485">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L2486">                return 0;</span>
            } else {
<span class="fc" id="L2488">                chLocal = charAt(bp + (offset++));</span>
            }
        }

        for (;;) {
<span class="fc bfc" id="L2493" title="All 2 branches covered.">            if (chLocal == expectNextChar) {</span>
<span class="fc" id="L2494">                bp += offset;</span>
<span class="fc" id="L2495">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L2496">                matchStat = VALUE;</span>
<span class="fc" id="L2497">                token = JSONToken.COMMA;</span>
<span class="fc bfc" id="L2498" title="All 2 branches covered.">                return negative ? -value : value;</span>
            } else {
<span class="fc bfc" id="L2500" title="All 2 branches covered.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2501">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2502">                    continue;</span>
                }

<span class="fc" id="L2505">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2506">                return value;</span>
            }
        }
    }

    public final float scanFieldFloat(char[] fieldName) {
<span class="fc" id="L2512">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L2514" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L2515">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L2516">            return 0;</span>
        }

<span class="fc" id="L2519">        int offset = fieldName.length;</span>
<span class="fc" id="L2520">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L2522" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2523" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2524">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2527" title="All 2 branches covered.">        boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2528" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2529">            chLocal = charAt(bp + (offset++));</span>
        }

        float value;
<span class="fc bfc" id="L2533" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2534">            long intVal = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L2536">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2537" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2538">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2539">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="fc" id="L2545">            long power = 1;</span>
<span class="fc bfc" id="L2546" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L2547" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L2548">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2549" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2550">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2551">                    power = 10;</span>
                    for (;;) {
<span class="fc" id="L2553">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2554" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2555">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2556">                            power *= 10;</span>
<span class="fc" id="L2557">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="fc" id="L2563">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2564">                    return 0;</span>
                }
            }

<span class="pc bpc" id="L2568" title="1 of 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="fc bfc" id="L2569" title="All 2 branches covered.">            if (exp) {</span>
<span class="fc" id="L2570">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2571" title="1 of 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="fc" id="L2572">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (;;) {
<span class="pc bpc" id="L2575" title="1 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2576">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="fc bfc" id="L2584" title="All 2 branches covered.">            if (quote) {</span>
<span class="pc bpc" id="L2585" title="1 of 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L2586">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2587">                    return 0;</span>
                } else {
<span class="fc" id="L2589">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="fc" id="L2591">                start = bp + fieldName.length + 1;</span>
<span class="fc" id="L2592">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L2594">                start = bp + fieldName.length;</span>
<span class="fc" id="L2595">                count = bp + offset - start - 1;</span>
            }

<span class="fc bfc" id="L2598" title="All 4 branches covered.">            if ((!exp) &amp;&amp; count &lt; 17) {</span>
<span class="fc" id="L2599">                value = (float) (((double) intVal) / power);</span>
<span class="fc bfc" id="L2600" title="All 2 branches covered.">                if (negative) {</span>
<span class="fc" id="L2601">                    value = -value;</span>
                }
            } else {
<span class="fc" id="L2604">                String text = this.subString(start, count);</span>
<span class="fc" id="L2605">                value = Float.parseFloat(text);</span>
            }
<span class="pc bpc" id="L2607" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2608">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2609">            value = 0;</span>
<span class="fc" id="L2610">            offset += 3;</span>
<span class="fc" id="L2611">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2613" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2614">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2618" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2619">                    bp += offset;</span>
<span class="fc" id="L2620">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2621">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2622">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2623">                    return value;</span>
<span class="fc bfc" id="L2624" title="All 2 branches covered.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L2625">                    bp += offset;</span>
<span class="fc" id="L2626">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2627">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2628">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L2629">                    return value;</span>
<span class="pc bpc" id="L2630" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2631">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2632">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2636">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2637">            return 0;</span>
        } else {
<span class="fc" id="L2639">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2640">            return 0;</span>
        }

<span class="fc bfc" id="L2643" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L2644">            bp += offset;</span>
<span class="fc" id="L2645">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2646">            matchStat = VALUE;</span>
<span class="fc" id="L2647">            token = JSONToken.COMMA;</span>
<span class="fc" id="L2648">            return value;</span>
        }

<span class="fc bfc" id="L2651" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L2652">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2653" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L2654">                token = JSONToken.COMMA;</span>
<span class="fc" id="L2655">                bp += offset;</span>
<span class="fc" id="L2656">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2657" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L2658">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2659">                bp += offset;</span>
<span class="fc" id="L2660">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2661" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L2662">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L2663">                bp += offset;</span>
<span class="fc" id="L2664">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2665" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L2666">                bp += (offset - 1);</span>
<span class="fc" id="L2667">                token = JSONToken.EOF;</span>
<span class="fc" id="L2668">                ch = EOI;</span>
            } else {
<span class="fc" id="L2670">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2671">                return 0;</span>
            }
<span class="fc" id="L2673">            matchStat = END;</span>
        } else {
<span class="fc" id="L2675">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2676">            return 0;</span>
        }

<span class="fc" id="L2679">        return value;</span>
    }

    public final float scanFloat(char seperator) {
<span class="fc" id="L2683">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2685">        int offset = 0;</span>
<span class="fc" id="L2686">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2687" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2688" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2689">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2692" title="All 2 branches covered.">        boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2693" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2694">            chLocal = charAt(bp + (offset++));</span>
        }

        float value;
<span class="pc bpc" id="L2698" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2699">            long intVal = chLocal - '0';</span>
            for (; ; ) {
<span class="fc" id="L2701">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2702" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2703">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2704">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="fc" id="L2710">            long power = 1;</span>
<span class="fc bfc" id="L2711" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L2712" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L2713">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2714" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2715">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2716">                    power = 10;</span>
                    for (; ; ) {
<span class="fc" id="L2718">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2719" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2720">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2721">                            power *= 10;</span>
<span class="fc" id="L2722">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="fc" id="L2728">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2729">                    return 0;</span>
                }
            }

<span class="pc bpc" id="L2733" title="1 of 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="fc bfc" id="L2734" title="All 2 branches covered.">            if (exp) {</span>
<span class="fc" id="L2735">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2736" title="2 of 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="fc" id="L2737">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (; ; ) {
<span class="pc bpc" id="L2740" title="1 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2741">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }
//            int start, count;
//            if (quote) {
//                if (chLocal != '&quot;') {
//                    matchStat = NOT_MATCH;
//                    return 0;
//                } else {
//                    chLocal = charAt(bp + (offset++));
//                }
//                start = bp + 1;
//                count = bp + offset - start - 2;
//            } else {
//                start = bp;
//                count = bp + offset - start - 1;
//            }
//            String text = this.subString(start, count);
//            value = Float.parseFloat(text);
            int start, count;
<span class="fc bfc" id="L2764" title="All 2 branches covered.">            if (quote) {</span>
<span class="pc bpc" id="L2765" title="1 of 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L2766">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2767">                    return 0;</span>
                } else {
<span class="fc" id="L2769">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="fc" id="L2771">                start = bp + 1;</span>
<span class="fc" id="L2772">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L2774">                start = bp;</span>
<span class="fc" id="L2775">                count = bp + offset - start - 1;</span>
            }

<span class="fc bfc" id="L2778" title="All 4 branches covered.">            if ((!exp) &amp;&amp; count &lt; 17) {</span>
<span class="fc" id="L2779">                value = (float) (((double) intVal) / power);</span>
<span class="fc bfc" id="L2780" title="All 2 branches covered.">                if (negative) {</span>
<span class="fc" id="L2781">                    value = -value;</span>
                }
            } else {
<span class="fc" id="L2784">                String text = this.subString(start, count);</span>
<span class="fc" id="L2785">                value = Float.parseFloat(text);</span>
            }
<span class="pc bpc" id="L2787" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2788">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2789">            value = 0;</span>
<span class="fc" id="L2790">            offset += 3;</span>
<span class="fc" id="L2791">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2793" title="2 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2794">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2798" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2799">                    bp += offset;</span>
<span class="fc" id="L2800">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2801">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2802">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2803">                    return value;</span>
<span class="fc bfc" id="L2804" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2805">                    bp += offset;</span>
<span class="fc" id="L2806">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2807">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2808">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2809">                    return value;</span>
<span class="pc bpc" id="L2810" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2811">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2812">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2816">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2817">            return 0;</span>
        } else {
<span class="fc" id="L2819">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2820">            return 0;</span>
        }

<span class="fc bfc" id="L2823" title="All 2 branches covered.">        if (chLocal == seperator) {</span>
<span class="fc" id="L2824">            bp += offset;</span>
<span class="fc" id="L2825">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2826">            matchStat = VALUE;</span>
<span class="fc" id="L2827">            token = JSONToken.COMMA;</span>
<span class="fc" id="L2828">            return value;</span>
        } else {
<span class="fc" id="L2830">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2831">            return value;</span>
        }
    }

    public double scanDouble(char seperator) {
<span class="fc" id="L2836">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2838">        int offset = 0;</span>
<span class="fc" id="L2839">        char chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2840" title="1 of 2 branches missed.">        final boolean quote = chLocal == '&quot;';</span>
<span class="pc bpc" id="L2841" title="1 of 2 branches missed.">        if (quote) {</span>
<span class="fc" id="L2842">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="pc bpc" id="L2845" title="1 of 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="pc bpc" id="L2846" title="1 of 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L2847">            chLocal = charAt(bp + (offset++));</span>
        }

        double value;
<span class="pc bpc" id="L2851" title="2 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2852">            long intVal = chLocal - '0';</span>
            for (; ; ) {
<span class="nc" id="L2854">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2855" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2856">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L2857">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="nc" id="L2863">            long power = 1;</span>
<span class="nc bnc" id="L2864" title="All 2 branches missed.">            boolean small = (chLocal == '.');</span>
<span class="nc bnc" id="L2865" title="All 2 branches missed.">            if (small) {</span>
<span class="nc" id="L2866">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2867" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2868">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L2869">                    power = 10;</span>
                    for (; ; ) {
<span class="nc" id="L2871">                        chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2872" title="All 4 branches missed.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2873">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L2874">                            power *= 10;</span>
<span class="nc" id="L2875">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="nc" id="L2881">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2882">                    return 0;</span>
                }
            }

<span class="nc bnc" id="L2886" title="All 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="nc bnc" id="L2887" title="All 2 branches missed.">            if (exp) {</span>
<span class="nc" id="L2888">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2889" title="All 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L2890">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (; ; ) {
<span class="nc bnc" id="L2893" title="All 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2894">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="nc bnc" id="L2902" title="All 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L2903" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L2904">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2905">                    return 0;</span>
                } else {
<span class="nc" id="L2907">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L2909">                start = bp + 1;</span>
<span class="nc" id="L2910">                count = bp + offset - start - 2;</span>
            } else {
<span class="nc" id="L2912">                start = bp;</span>
<span class="nc" id="L2913">                count = bp + offset - start - 1;</span>
            }

<span class="nc bnc" id="L2916" title="All 4 branches missed.">            if (!exp &amp;&amp; count &lt; 17) {</span>
<span class="nc" id="L2917">                value = ((double) intVal) / power;</span>
<span class="nc bnc" id="L2918" title="All 2 branches missed.">                if (negative) {</span>
<span class="nc" id="L2919">                    value = -value;</span>
                }
            } else {
<span class="nc" id="L2922">                String text = this.subString(start, count);</span>
<span class="nc" id="L2923">                value = Double.parseDouble(text);</span>
            }
<span class="pc bpc" id="L2925" title="4 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2926">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2927">            value = 0;</span>
<span class="fc" id="L2928">            offset += 3;</span>
<span class="fc" id="L2929">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2931" title="2 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2932">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2936" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2937">                    bp += offset;</span>
<span class="fc" id="L2938">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2939">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2940">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2941">                    return value;</span>
<span class="fc bfc" id="L2942" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2943">                    bp += offset;</span>
<span class="fc" id="L2944">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2945">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2946">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2947">                    return value;</span>
<span class="pc bpc" id="L2948" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2949">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2950">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2954">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2955">            return 0;</span>
        } else {
<span class="nc" id="L2957">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2958">            return 0;</span>
        }

<span class="nc bnc" id="L2961" title="All 2 branches missed.">        if (chLocal == seperator) {</span>
<span class="nc" id="L2962">            bp += offset;</span>
<span class="nc" id="L2963">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L2964">            matchStat = VALUE;</span>
<span class="nc" id="L2965">            token = JSONToken.COMMA;</span>
<span class="nc" id="L2966">            return value;</span>
        } else {
<span class="nc" id="L2968">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2969">            return value;</span>
        }
    }

    public BigDecimal scanDecimal(char seperator) {
<span class="nc" id="L2974">        matchStat = UNKNOWN;</span>

<span class="nc" id="L2976">        int offset = 0;</span>
<span class="nc" id="L2977">        char chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2978" title="All 2 branches missed.">        final boolean quote = chLocal == '&quot;';</span>
<span class="nc bnc" id="L2979" title="All 2 branches missed.">        if (quote) {</span>
<span class="nc" id="L2980">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="nc bnc" id="L2983" title="All 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="nc bnc" id="L2984" title="All 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L2985">            chLocal = charAt(bp + (offset++));</span>
        }

        BigDecimal value;
<span class="nc bnc" id="L2989" title="All 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
            for (;;) {
<span class="nc" id="L2991">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2992" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2993">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="nc bnc" id="L2999" title="All 2 branches missed.">            boolean small = (chLocal == '.');</span>
<span class="nc bnc" id="L3000" title="All 2 branches missed.">            if (small) {</span>
<span class="nc" id="L3001">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3002" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
                    for (;;) {
<span class="nc" id="L3004">                        chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3005" title="All 4 branches missed.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3006">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="nc" id="L3012">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3013">                    return null;</span>
                }
            }

<span class="nc bnc" id="L3017" title="All 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="nc bnc" id="L3018" title="All 2 branches missed.">            if (exp) {</span>
<span class="nc" id="L3019">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3020" title="All 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L3021">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (;;) {
<span class="nc bnc" id="L3024" title="All 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3025">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="nc bnc" id="L3033" title="All 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L3034" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L3035">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3036">                    return null;</span>
                } else {
<span class="nc" id="L3038">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L3040">                start = bp + 1;</span>
<span class="nc" id="L3041">                count = bp + offset - start - 2;</span>
            } else {
<span class="nc" id="L3043">                start = bp;</span>
<span class="nc" id="L3044">                count = bp + offset - start - 1;</span>
            }

<span class="nc bnc" id="L3047" title="All 2 branches missed.">            if (count &gt; 65535) {</span>
<span class="nc" id="L3048">                throw new JSONException(&quot;decimal overflow&quot;);</span>
            }
<span class="nc" id="L3050">            char[] chars = this.sub_chars(start, count);</span>
<span class="nc" id="L3051">            value = new BigDecimal(chars, 0, chars.length, MathContext.UNLIMITED);</span>
<span class="nc bnc" id="L3052" title="All 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="nc" id="L3053">            matchStat = VALUE_NULL;</span>
<span class="nc" id="L3054">            value = null;</span>
<span class="nc" id="L3055">            offset += 3;</span>
<span class="nc" id="L3056">            chLocal = charAt(bp + offset++);</span>

<span class="nc bnc" id="L3058" title="All 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="nc" id="L3059">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="nc bnc" id="L3063" title="All 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L3064">                    bp += offset;</span>
<span class="nc" id="L3065">                    this.ch = charAt(bp);</span>
<span class="nc" id="L3066">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L3067">                    token = JSONToken.COMMA;</span>
<span class="nc" id="L3068">                    return value;</span>
<span class="nc bnc" id="L3069" title="All 2 branches missed.">                } else if (chLocal == '}') {</span>
<span class="nc" id="L3070">                    bp += offset;</span>
<span class="nc" id="L3071">                    this.ch = charAt(bp);</span>
<span class="nc" id="L3072">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L3073">                    token = JSONToken.RBRACE;</span>
<span class="nc" id="L3074">                    return value;</span>
<span class="nc bnc" id="L3075" title="All 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L3076">                    chLocal = charAt(bp + offset++);</span>
<span class="nc" id="L3077">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L3081">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3082">            return null;</span>
        } else {
<span class="nc" id="L3084">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3085">            return null;</span>
        }

<span class="nc bnc" id="L3088" title="All 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L3089">            bp += offset;</span>
<span class="nc" id="L3090">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L3091">            matchStat = VALUE;</span>
<span class="nc" id="L3092">            token = JSONToken.COMMA;</span>
<span class="nc" id="L3093">            return value;</span>
        }

<span class="nc bnc" id="L3096" title="All 2 branches missed.">        if (chLocal == ']') {</span>
<span class="nc" id="L3097">            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3098" title="All 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3099">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3100">                bp += offset;</span>
<span class="nc" id="L3101">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L3102" title="All 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3103">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3104">                bp += offset;</span>
<span class="nc" id="L3105">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L3106" title="All 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3107">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3108">                bp += offset;</span>
<span class="nc" id="L3109">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L3110" title="All 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="nc" id="L3111">                token = JSONToken.EOF;</span>
<span class="nc" id="L3112">                bp += (offset - 1);</span>
<span class="nc" id="L3113">                ch = EOI;</span>
            } else {
<span class="nc" id="L3115">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3116">                return null;</span>
            }
<span class="nc" id="L3118">            matchStat = END;</span>
        } else {
<span class="nc" id="L3120">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3121">            return null;</span>
        }

<span class="nc" id="L3124">        return value;</span>
    }

    public final float[] scanFieldFloatArray(char[] fieldName) {
<span class="fc" id="L3128">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L3130" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L3131">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3132">            return null;</span>
        }

<span class="fc" id="L3135">        int offset = fieldName.length;</span>
<span class="fc" id="L3136">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3137" title="All 2 branches covered.">        if (chLocal != '[') {</span>
<span class="fc" id="L3138">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3139">            return null;</span>
        }
<span class="fc" id="L3141">        chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3143">        float[] array = new float[16];</span>
<span class="fc" id="L3144">        int arrayIndex = 0;</span>

        for (;;) {
<span class="fc" id="L3147">            int start = bp + offset - 1;</span>

<span class="fc bfc" id="L3149" title="All 2 branches covered.">            boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L3150" title="All 2 branches covered.">            if (negative) {</span>
<span class="fc" id="L3151">                chLocal = charAt(bp + (offset++));</span>
            }

<span class="pc bpc" id="L3154" title="1 of 4 branches missed.">            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3155">                int intVal = chLocal - '0';</span>
                for (; ; ) {
<span class="fc" id="L3157">                    chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3158" title="3 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3159">                        intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L3160">                        continue;</span>
                    } else {
                        break;
                    }
                }

<span class="fc" id="L3166">                int power = 1;</span>
<span class="fc bfc" id="L3167" title="All 2 branches covered.">                boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L3168" title="All 2 branches covered.">                if (small) {</span>
<span class="fc" id="L3169">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L3170">                    power = 10;</span>
<span class="pc bpc" id="L3171" title="2 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3172">                        intVal = intVal * 10 + (chLocal - '0');</span>
                        for (; ; ) {
<span class="fc" id="L3174">                            chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L3176" title="All 4 branches covered.">                            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3177">                                intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3178">                                power *= 10;</span>
<span class="fc" id="L3179">                                continue;</span>
                            } else {
                                break;
                            }
                        }
                    } else {
<span class="nc" id="L3185">                        matchStat = NOT_MATCH;</span>
<span class="nc" id="L3186">                        return null;</span>
                    }
                }

<span class="pc bpc" id="L3190" title="1 of 4 branches missed.">                boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="fc bfc" id="L3191" title="All 2 branches covered.">                if (exp) {</span>
<span class="fc" id="L3192">                    chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3193" title="2 of 4 branches missed.">                    if (chLocal == '+' || chLocal == '-') {</span>
<span class="fc" id="L3194">                        chLocal = charAt(bp + (offset++));</span>
                    }
                    for (;;) {
<span class="pc bpc" id="L3197" title="1 of 4 branches missed.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3198">                            chLocal = charAt(bp + (offset++));</span>
                        } else {
                            break;
                        }
                    }
                }

<span class="fc" id="L3205">                int count = bp + offset - start - 1;</span>

                float value;
<span class="fc bfc" id="L3208" title="All 4 branches covered.">                if (!exp &amp;&amp; count &lt; 10) {</span>
<span class="fc" id="L3209">                    value = ((float) intVal) / power;</span>
<span class="fc bfc" id="L3210" title="All 2 branches covered.">                    if (negative) {</span>
<span class="fc" id="L3211">                        value = -value;</span>
                    }
                } else {
<span class="fc" id="L3214">                    String text = this.subString(start, count);</span>
<span class="fc" id="L3215">                    value = Float.parseFloat(text);</span>
                }

<span class="pc bpc" id="L3218" title="1 of 2 branches missed.">                if (arrayIndex &gt;= array.length) {</span>
<span class="nc" id="L3219">                    float[] tmp = new float[array.length * 3 / 2];</span>
<span class="nc" id="L3220">                    System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L3221">                    array = tmp;</span>
                }
<span class="fc" id="L3223">                array[arrayIndex++] = value;</span>

<span class="fc bfc" id="L3225" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L3226">                    chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3227" title="1 of 2 branches missed.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L3228">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L3229">                    break;</span>
                }
<span class="fc" id="L3231">            } else {</span>
<span class="fc" id="L3232">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L3233">                return null;</span>
            }
<span class="fc" id="L3235">        }</span>


<span class="pc bpc" id="L3238" title="1 of 2 branches missed.">        if (arrayIndex != array.length) {</span>
<span class="fc" id="L3239">            float[] tmp = new float[arrayIndex];</span>
<span class="fc" id="L3240">            System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="fc" id="L3241">            array = tmp;</span>
        }

<span class="pc bpc" id="L3244" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L3245">            bp += (offset - 1);</span>
<span class="nc" id="L3246">            this.next();</span>
<span class="nc" id="L3247">            matchStat = VALUE;</span>
<span class="nc" id="L3248">            token = JSONToken.COMMA;</span>
<span class="nc" id="L3249">            return array;</span>
        }

<span class="pc bpc" id="L3252" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L3253">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3254" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3255">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3256">                bp += (offset - 1);</span>
<span class="nc" id="L3257">                this.next();</span>
<span class="pc bpc" id="L3258" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3259">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3260">                bp += (offset - 1);</span>
<span class="nc" id="L3261">                this.next();</span>
<span class="pc bpc" id="L3262" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3263">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3264">                bp += (offset - 1);</span>
<span class="nc" id="L3265">                this.next();</span>
<span class="pc bpc" id="L3266" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3267">                bp += (offset - 1);</span>
<span class="fc" id="L3268">                token = JSONToken.EOF;</span>
<span class="fc" id="L3269">                ch = EOI;</span>
            } else {
<span class="nc" id="L3271">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3272">                return null;</span>
            }
<span class="fc" id="L3274">            matchStat = END;</span>
        } else {
<span class="nc" id="L3276">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3277">            return null;</span>
        }

<span class="fc" id="L3280">        return array;</span>
    }

    public final float[][] scanFieldFloatArray2(char[] fieldName) {
<span class="fc" id="L3284">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L3286" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L3287">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3288">            return null;</span>
        }

<span class="fc" id="L3291">        int offset = fieldName.length;</span>
<span class="fc" id="L3292">        char chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3294" title="1 of 2 branches missed.">        if (chLocal != '[') {</span>
<span class="nc" id="L3295">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3296">            return null;</span>
        }
<span class="fc" id="L3298">        chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3300">        float[][] arrayarray = new float[16][];</span>
<span class="fc" id="L3301">        int arrayarrayIndex = 0;</span>

        for (;;) {
<span class="fc bfc" id="L3304" title="All 2 branches covered.">            if (chLocal == '[') {</span>
<span class="fc" id="L3305">                chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3307">                float[] array = new float[16];</span>
<span class="fc" id="L3308">                int arrayIndex = 0;</span>

                for (; ; ) {
<span class="fc" id="L3311">                    int start = bp + offset - 1;</span>
<span class="fc bfc" id="L3312" title="All 2 branches covered.">                    boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L3313" title="All 2 branches covered.">                    if (negative) {</span>
<span class="fc" id="L3314">                        chLocal = charAt(bp + (offset++));</span>
                    }

<span class="pc bpc" id="L3317" title="2 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3318">                        int intVal = chLocal - '0';</span>
                        for (; ; ) {
<span class="fc" id="L3320">                            chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3322" title="3 of 4 branches missed.">                            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3323">                                intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L3324">                                continue;</span>
                            } else {
                                break;
                            }
                        }

<span class="fc" id="L3330">                        int power = 1;</span>
<span class="fc bfc" id="L3331" title="All 2 branches covered.">                        if (chLocal == '.') {</span>
<span class="fc" id="L3332">                            chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3334" title="2 of 4 branches missed.">                            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3335">                                intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3336">                                power = 10;</span>
                                for (; ; ) {
<span class="fc" id="L3338">                                    chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3340" title="1 of 4 branches missed.">                                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3341">                                        intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L3342">                                        power *= 10;</span>
<span class="nc" id="L3343">                                        continue;</span>
                                    } else {
                                        break;
                                    }
                                }
                            } else {
<span class="nc" id="L3349">                                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3350">                                return null;</span>
                            }
                        }

<span class="pc bpc" id="L3354" title="2 of 4 branches missed.">                        boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="pc bpc" id="L3355" title="1 of 2 branches missed.">                        if (exp) {</span>
<span class="nc" id="L3356">                            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3357" title="All 4 branches missed.">                            if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L3358">                                chLocal = charAt(bp + (offset++));</span>
                            }
                            for (;;) {
<span class="nc bnc" id="L3361" title="All 4 branches missed.">                                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3362">                                    chLocal = charAt(bp + (offset++));</span>
                                } else {
                                    break;
                                }
                            }
                        }

<span class="fc" id="L3369">                        int count = bp + offset - start - 1;</span>
                        float value;
<span class="pc bpc" id="L3371" title="2 of 4 branches missed.">                        if (!exp &amp;&amp; count &lt; 10) {</span>
<span class="fc" id="L3372">                            value = ((float) intVal) / power;</span>
<span class="fc bfc" id="L3373" title="All 2 branches covered.">                            if (negative) {</span>
<span class="fc" id="L3374">                                value = -value;</span>
                            }
                        } else {
<span class="nc" id="L3377">                            String text = this.subString(start, count);</span>
<span class="nc" id="L3378">                            value = Float.parseFloat(text);</span>
                        }

<span class="pc bpc" id="L3381" title="1 of 2 branches missed.">                        if (arrayIndex &gt;= array.length) {</span>
<span class="nc" id="L3382">                            float[] tmp = new float[array.length * 3 / 2];</span>
<span class="nc" id="L3383">                            System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L3384">                            array = tmp;</span>
                        }
<span class="fc" id="L3386">                        array[arrayIndex++] = value;</span>

<span class="fc bfc" id="L3388" title="All 2 branches covered.">                        if (chLocal == ',') {</span>
<span class="fc" id="L3389">                            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3390" title="1 of 2 branches missed.">                        } else if (chLocal == ']') {</span>
<span class="fc" id="L3391">                            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L3392">                            break;</span>
                        }
<span class="fc" id="L3394">                    } else {</span>
<span class="nc" id="L3395">                        matchStat = NOT_MATCH;</span>
<span class="nc" id="L3396">                        return null;</span>
                    }
<span class="fc" id="L3398">                }</span>

                // compact
<span class="pc bpc" id="L3401" title="1 of 2 branches missed.">                if (arrayIndex != array.length) {</span>
<span class="fc" id="L3402">                    float[] tmp = new float[arrayIndex];</span>
<span class="fc" id="L3403">                    System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="fc" id="L3404">                    array = tmp;</span>
                }

<span class="pc bpc" id="L3407" title="1 of 2 branches missed.">                if (arrayarrayIndex &gt;= arrayarray.length) {</span>
<span class="nc" id="L3408">                    float[][] tmp = new float[arrayarray.length * 3 / 2][];</span>
<span class="nc" id="L3409">                    System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L3410">                    arrayarray = tmp;</span>
                }
<span class="fc" id="L3412">                arrayarray[arrayarrayIndex++] = array;</span>

<span class="pc bpc" id="L3414" title="1 of 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L3415">                    chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3416" title="1 of 2 branches missed.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L3417">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L3418">                    break;</span>
                }
<span class="nc" id="L3420">            } else {</span>
                break;
            }
        }

        // compact
<span class="pc bpc" id="L3426" title="1 of 2 branches missed.">        if (arrayarrayIndex != arrayarray.length) {</span>
<span class="fc" id="L3427">            float[][] tmp = new float[arrayarrayIndex][];</span>
<span class="fc" id="L3428">            System.arraycopy(arrayarray, 0, tmp, 0, arrayarrayIndex);</span>
<span class="fc" id="L3429">            arrayarray = tmp;</span>
        }

<span class="pc bpc" id="L3432" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L3433">            bp += (offset - 1);</span>
<span class="nc" id="L3434">            this.next();</span>
<span class="nc" id="L3435">            matchStat = VALUE;</span>
<span class="nc" id="L3436">            token = JSONToken.COMMA;</span>
<span class="nc" id="L3437">            return arrayarray;</span>
        }

<span class="fc bfc" id="L3440" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L3441">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3442" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3443">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3444">                bp += (offset - 1);</span>
<span class="nc" id="L3445">                this.next();</span>
<span class="pc bpc" id="L3446" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3447">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3448">                bp += (offset - 1);</span>
<span class="nc" id="L3449">                this.next();</span>
<span class="pc bpc" id="L3450" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3451">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3452">                bp += (offset - 1);</span>
<span class="nc" id="L3453">                this.next();</span>
<span class="pc bpc" id="L3454" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3455">                bp += (offset - 1);</span>
<span class="fc" id="L3456">                token = JSONToken.EOF;</span>
<span class="fc" id="L3457">                ch = EOI;</span>
            } else {
<span class="nc" id="L3459">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3460">                return null;</span>
            }
<span class="fc" id="L3462">            matchStat = END;</span>
        } else {
<span class="fc" id="L3464">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3465">            return null;</span>
        }

<span class="fc" id="L3468">        return arrayarray;</span>
    }

    public final double scanFieldDouble(char[] fieldName) {
<span class="fc" id="L3472">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L3474" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L3475">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3476">            return 0;</span>
        }

<span class="fc" id="L3479">        int offset = fieldName.length;</span>
<span class="fc" id="L3480">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3481" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L3482" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L3483">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L3486" title="All 2 branches covered.">        boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L3487" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L3488">            chLocal = charAt(bp + (offset++));</span>
        }

        double value;
<span class="fc bfc" id="L3492" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3493">            long intVal = chLocal - '0';</span>

            for (;;) {
<span class="fc" id="L3496">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3497" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3498">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3499">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="fc" id="L3505">            long power = 1;</span>
<span class="fc bfc" id="L3506" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L3507" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L3508">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3509" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3510">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3511">                    power = 10;</span>
                    for (;;) {
<span class="fc" id="L3513">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3514" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3515">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3516">                            power *= 10;</span>
<span class="fc" id="L3517">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="fc" id="L3523">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L3524">                    return 0;</span>
                }
            }

<span class="fc bfc" id="L3528" title="All 4 branches covered.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="fc bfc" id="L3529" title="All 2 branches covered.">            if (exp) {</span>
<span class="fc" id="L3530">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3531" title="All 4 branches covered.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="fc" id="L3532">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (;;) {
<span class="fc bfc" id="L3535" title="All 4 branches covered.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3536">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="fc bfc" id="L3544" title="All 2 branches covered.">            if (quote) {</span>
<span class="pc bpc" id="L3545" title="1 of 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L3546">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3547">                    return 0;</span>
                } else {
<span class="fc" id="L3549">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="fc" id="L3551">                start = bp + fieldName.length + 1;</span>
<span class="fc" id="L3552">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L3554">                start = bp + fieldName.length;</span>
<span class="fc" id="L3555">                count = bp + offset - start - 1;</span>
            }

<span class="fc bfc" id="L3558" title="All 4 branches covered.">            if (!exp &amp;&amp; count &lt; 17) {</span>
<span class="fc" id="L3559">                value = ((double) intVal) / power;</span>
<span class="fc bfc" id="L3560" title="All 2 branches covered.">                if (negative) {</span>
<span class="fc" id="L3561">                    value = -value;</span>
                }
            } else {
<span class="fc" id="L3564">                String text = this.subString(start, count);</span>
<span class="fc" id="L3565">                value = Double.parseDouble(text);</span>
            }
<span class="fc bfc" id="L3567" title="All 2 branches covered.">        } else if (chLocal == 'n' &amp;&amp;</span>
<span class="pc bpc" id="L3568" title="1 of 2 branches missed.">                   charAt(bp + offset) == 'u' &amp;&amp;</span>
<span class="pc bpc" id="L3569" title="1 of 2 branches missed.">                   charAt(bp + offset + 1) == 'l' &amp;&amp;</span>
<span class="pc bpc" id="L3570" title="1 of 2 branches missed.">                   charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L3571">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L3572">            value = 0;</span>
<span class="fc" id="L3573">            offset += 3;</span>
<span class="fc" id="L3574">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L3576" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L3577">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L3581" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L3582">                    bp += offset;</span>
<span class="fc" id="L3583">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3584">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3585">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L3586">                    return value;</span>
<span class="fc bfc" id="L3587" title="All 2 branches covered.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L3588">                    bp += offset;</span>
<span class="fc" id="L3589">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3590">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3591">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L3592">                    return value;</span>
<span class="pc bpc" id="L3593" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L3594">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L3595">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L3599">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3600">            return 0;</span>
        } else {
<span class="fc" id="L3602">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3603">            return 0;</span>
        }

<span class="fc bfc" id="L3606" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L3607">            bp += offset;</span>
<span class="fc" id="L3608">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L3609">            matchStat = VALUE;</span>
<span class="fc" id="L3610">            token = JSONToken.COMMA;</span>
<span class="fc" id="L3611">            return value;</span>
        }

<span class="fc bfc" id="L3614" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L3615">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3616" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L3617">                token = JSONToken.COMMA;</span>
<span class="fc" id="L3618">                bp += offset;</span>
<span class="fc" id="L3619">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L3620" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L3621">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L3622">                bp += offset;</span>
<span class="fc" id="L3623">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L3624" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L3625">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L3626">                bp += offset;</span>
<span class="fc" id="L3627">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L3628" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3629">                token = JSONToken.EOF;</span>
<span class="fc" id="L3630">                bp += (offset - 1);</span>
<span class="fc" id="L3631">                ch = EOI;</span>
            } else {
<span class="fc" id="L3633">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L3634">                return 0;</span>
            }
<span class="fc" id="L3636">            matchStat = END;</span>
        } else {
<span class="fc" id="L3638">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3639">            return 0;</span>
        }

<span class="fc" id="L3642">        return value;</span>
    }

    public BigDecimal scanFieldDecimal(char[] fieldName) {
<span class="fc" id="L3646">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L3648" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L3649">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3650">            return null;</span>
        }

<span class="fc" id="L3653">        int offset = fieldName.length;</span>
<span class="fc" id="L3654">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3655" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L3656" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L3657">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="pc bpc" id="L3660" title="1 of 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="pc bpc" id="L3661" title="1 of 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L3662">            chLocal = charAt(bp + (offset++));</span>
        }

        BigDecimal value;
<span class="pc bpc" id="L3666" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
            for (;;) {
<span class="fc" id="L3668">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3669" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3670">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="fc bfc" id="L3676" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L3677" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L3678">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3679" title="2 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
                    for (;;) {
<span class="fc" id="L3681">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3682" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3683">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="nc" id="L3689">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3690">                    return null;</span>
                }
            }

<span class="pc bpc" id="L3694" title="2 of 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="pc bpc" id="L3695" title="1 of 2 branches missed.">            if (exp) {</span>
<span class="nc" id="L3696">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3697" title="All 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L3698">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (;;) {
<span class="nc bnc" id="L3701" title="All 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3702">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="pc bpc" id="L3710" title="1 of 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L3711" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L3712">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3713">                    return null;</span>
                } else {
<span class="nc" id="L3715">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L3717">                start = bp + fieldName.length + 1;</span>
<span class="nc" id="L3718">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L3720">                start = bp + fieldName.length;</span>
<span class="fc" id="L3721">                count = bp + offset - start - 1;</span>
            }

<span class="pc bpc" id="L3724" title="1 of 2 branches missed.">            if (count &gt; 65535) {</span>
<span class="nc" id="L3725">                throw new JSONException(&quot;scan decimal overflow&quot;);</span>
            }

<span class="fc" id="L3728">            char[] chars = this.sub_chars(start, count);</span>
<span class="fc" id="L3729">            value = new BigDecimal(chars, 0, chars.length, MathContext.UNLIMITED);</span>
<span class="fc bfc" id="L3730" title="All 2 branches covered.">        } else if (chLocal == 'n' &amp;&amp;</span>
<span class="pc bpc" id="L3731" title="1 of 2 branches missed.">                   charAt(bp + offset) == 'u' &amp;&amp;</span>
<span class="pc bpc" id="L3732" title="1 of 2 branches missed.">                   charAt(bp + offset + 1) == 'l' &amp;&amp;</span>
<span class="pc bpc" id="L3733" title="1 of 2 branches missed.">                   charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L3734">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L3735">            value = null;</span>
<span class="fc" id="L3736">            offset += 3;</span>
<span class="fc" id="L3737">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L3739" title="3 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="nc" id="L3740">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="pc bpc" id="L3744" title="1 of 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L3745">                    bp += offset;</span>
<span class="nc" id="L3746">                    this.ch = charAt(bp);</span>
<span class="nc" id="L3747">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L3748">                    token = JSONToken.COMMA;</span>
<span class="nc" id="L3749">                    return value;</span>
<span class="pc bpc" id="L3750" title="1 of 2 branches missed.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L3751">                    bp += offset;</span>
<span class="fc" id="L3752">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3753">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3754">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L3755">                    return value;</span>
<span class="nc bnc" id="L3756" title="All 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L3757">                    chLocal = charAt(bp + offset++);</span>
<span class="nc" id="L3758">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L3762">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3763">            return null;</span>
        } else {
<span class="fc" id="L3765">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3766">            return null;</span>
        }

<span class="fc bfc" id="L3769" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L3770">            bp += offset;</span>
<span class="fc" id="L3771">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L3772">            matchStat = VALUE;</span>
<span class="fc" id="L3773">            token = JSONToken.COMMA;</span>
<span class="fc" id="L3774">            return value;</span>
        }

<span class="pc bpc" id="L3777" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L3778">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3779" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3780">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3781">                bp += offset;</span>
<span class="nc" id="L3782">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L3783" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L3784">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L3785">                bp += offset;</span>
<span class="fc" id="L3786">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3787" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3788">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3789">                bp += offset;</span>
<span class="nc" id="L3790">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3791" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3792">                token = JSONToken.EOF;</span>
<span class="fc" id="L3793">                bp += (offset - 1);</span>
<span class="fc" id="L3794">                ch = EOI;</span>
            } else {
<span class="nc" id="L3796">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3797">                return null;</span>
            }
<span class="fc" id="L3799">            matchStat = END;</span>
        } else {
<span class="nc" id="L3801">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3802">            return null;</span>
        }

<span class="fc" id="L3805">        return value;</span>
    }

    public BigInteger scanFieldBigInteger(char[] fieldName) {
<span class="fc" id="L3809">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L3811" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L3812">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3813">            return null;</span>
        }

<span class="fc" id="L3816">        int offset = fieldName.length;</span>
<span class="fc" id="L3817">        char chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3818" title="1 of 2 branches missed.">        final boolean quote = chLocal == '&quot;';</span>
<span class="pc bpc" id="L3819" title="1 of 2 branches missed.">        if (quote) {</span>
<span class="nc" id="L3820">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="pc bpc" id="L3823" title="1 of 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="pc bpc" id="L3824" title="1 of 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L3825">            chLocal = charAt(bp + (offset++));</span>
        }

        BigInteger value;
<span class="pc bpc" id="L3829" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3830">            long intVal = chLocal - '0';</span>
<span class="fc" id="L3831">            boolean overflow = false;</span>
            long temp;
            for (;;) {
<span class="fc" id="L3834">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3835" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3836">                    temp = intVal * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L3837" title="All 2 branches covered.">                    if (temp &lt; intVal) {</span>
<span class="fc" id="L3838">                        overflow = true;</span>
<span class="fc" id="L3839">                        break;</span>
                    }
<span class="fc" id="L3841">                    intVal = temp;</span>
<span class="fc" id="L3842">                    continue;</span>
                } else {
                    break;
                }
            }

            int start, count;
<span class="pc bpc" id="L3849" title="1 of 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L3850" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L3851">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3852">                    return null;</span>
                } else {
<span class="nc" id="L3854">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L3856">                start = bp + fieldName.length + 1;</span>
<span class="nc" id="L3857">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L3859">                start = bp + fieldName.length;</span>
<span class="fc" id="L3860">                count = bp + offset - start - 1;</span>
            }

<span class="pc bpc" id="L3863" title="5 of 8 branches missed.">            if (!overflow &amp;&amp; (count &lt; 20 || (negative &amp;&amp; count &lt; 21))) {</span>
<span class="pc bpc" id="L3864" title="1 of 2 branches missed.">                value = BigInteger.valueOf(negative ? -intVal : intVal);</span>
            } else {

//            char[] chars = this.sub_chars(negative ? start + 1 : start, count);
//            value = new BigInteger(chars, )
<span class="pc bpc" id="L3869" title="1 of 2 branches missed.">                if (count &gt; 65535) {</span>
<span class="nc" id="L3870">                    throw new JSONException(&quot;scanInteger overflow&quot;);</span>
                }

<span class="fc" id="L3873">                String strVal = this.subString(start, count);</span>
<span class="fc" id="L3874">                value = new BigInteger(strVal, 10);</span>
            }
<span class="pc bpc" id="L3876" title="1 of 2 branches missed.">        } else if (chLocal == 'n' &amp;&amp;</span>
<span class="pc bpc" id="L3877" title="1 of 2 branches missed.">                   charAt(bp + offset) == 'u' &amp;&amp;</span>
<span class="pc bpc" id="L3878" title="1 of 2 branches missed.">                   charAt(bp + offset + 1) == 'l' &amp;&amp;</span>
<span class="pc bpc" id="L3879" title="1 of 2 branches missed.">                   charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L3880">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L3881">            value = null;</span>
<span class="fc" id="L3882">            offset += 3;</span>
<span class="fc" id="L3883">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L3885" title="3 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="nc" id="L3886">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="pc bpc" id="L3890" title="1 of 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L3891">                    bp += offset;</span>
<span class="nc" id="L3892">                    this.ch = charAt(bp);</span>
<span class="nc" id="L3893">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L3894">                    token = JSONToken.COMMA;</span>
<span class="nc" id="L3895">                    return value;</span>
<span class="pc bpc" id="L3896" title="1 of 2 branches missed.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L3897">                    bp += offset;</span>
<span class="fc" id="L3898">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3899">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3900">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L3901">                    return value;</span>
<span class="nc bnc" id="L3902" title="All 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L3903">                    chLocal = charAt(bp + offset++);</span>
<span class="nc" id="L3904">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L3908">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3909">            return null;</span>
        } else {
<span class="nc" id="L3911">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3912">            return null;</span>
        }

<span class="pc bpc" id="L3915" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L3916">            bp += offset;</span>
<span class="nc" id="L3917">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L3918">            matchStat = VALUE;</span>
<span class="nc" id="L3919">            token = JSONToken.COMMA;</span>
<span class="nc" id="L3920">            return value;</span>
        }

<span class="fc bfc" id="L3923" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L3924">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3925" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3926">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3927">                bp += offset;</span>
<span class="nc" id="L3928">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3929" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3930">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3931">                bp += offset;</span>
<span class="nc" id="L3932">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3933" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3934">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3935">                bp += offset;</span>
<span class="nc" id="L3936">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3937" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3938">                token = JSONToken.EOF;</span>
<span class="fc" id="L3939">                bp += (offset - 1);</span>
<span class="fc" id="L3940">                ch = EOI;</span>
            } else {
<span class="nc" id="L3942">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3943">                return null;</span>
            }
<span class="fc" id="L3945">            matchStat = END;</span>
        } else {
<span class="fc" id="L3947">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3948">            return null;</span>
        }

<span class="fc" id="L3951">        return value;</span>
    }

    public java.util.Date scanFieldDate(char[] fieldName) {
<span class="fc" id="L3955">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L3957" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L3958">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3959">            return null;</span>
        }

        // int index = bp + fieldName.length;

<span class="fc" id="L3964">        int offset = fieldName.length;</span>
<span class="fc" id="L3965">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.Date dateVal;
<span class="fc bfc" id="L3968" title="All 2 branches covered.">        if (chLocal == '&quot;'){</span>
<span class="fc" id="L3969">            int startIndex = bp + fieldName.length + 1;</span>
<span class="fc" id="L3970">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="pc bpc" id="L3971" title="1 of 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L3972">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L3975">            int startIndex2 = bp + fieldName.length + 1; // must re compute</span>
<span class="fc" id="L3976">            String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="pc bpc" id="L3977" title="1 of 2 branches missed.">            if (stringVal.indexOf('\\') != -1) {</span>
                for (;;) {
<span class="nc" id="L3979">                    int slashCount = 0;</span>
<span class="nc bnc" id="L3980" title="All 2 branches missed.">                    for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="nc bnc" id="L3981" title="All 2 branches missed.">                        if (charAt(i) == '\\') {</span>
<span class="nc" id="L3982">                            slashCount++;</span>
                        } else {
                            break;
                        }
                    }
<span class="nc bnc" id="L3987" title="All 2 branches missed.">                    if (slashCount % 2 == 0) {</span>
<span class="nc" id="L3988">                        break;</span>
                    }
<span class="nc" id="L3990">                    endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="nc" id="L3991">                }</span>

<span class="nc" id="L3993">                int chars_len = endIndex - (bp + fieldName.length + 1);</span>
<span class="nc" id="L3994">                char[] chars = sub_chars( bp + fieldName.length + 1, chars_len);</span>

<span class="nc" id="L3996">                stringVal = readString(chars, chars_len);</span>
            }

<span class="fc" id="L3999">            offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="fc" id="L4000">            chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L4002">            JSONScanner dateLexer = new JSONScanner(stringVal);</span>
            try {
<span class="fc bfc" id="L4004" title="All 2 branches covered.">                if (dateLexer.scanISO8601DateIfMatch(false)) {</span>
<span class="fc" id="L4005">                    Calendar calendar = dateLexer.getCalendar();</span>
<span class="fc" id="L4006">                    dateVal = calendar.getTime();</span>
<span class="fc" id="L4007">                } else {</span>
<span class="fc" id="L4008">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L4009">                    return null;</span>
                }
            } finally {
<span class="fc" id="L4012">                dateLexer.close();</span>
            }
<span class="pc bpc" id="L4014" title="3 of 6 branches missed.">        } else if (chLocal == '-' || (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9')) {</span>
<span class="fc" id="L4015">            long millis = 0;</span>

<span class="fc" id="L4017">            boolean negative = false;</span>
<span class="pc bpc" id="L4018" title="1 of 2 branches missed.">            if (chLocal == '-') {</span>
<span class="nc" id="L4019">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L4020">                negative = true;</span>
            }

<span class="pc bpc" id="L4023" title="2 of 4 branches missed.">            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L4024">                millis = chLocal - '0';</span>
                for (; ; ) {
<span class="fc" id="L4026">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L4027" title="All 4 branches covered.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L4028">                        millis = millis * 10 + (chLocal - '0');</span>
                    } else {
                        break;
                    }
                }
            }

<span class="pc bpc" id="L4035" title="1 of 2 branches missed.">            if (millis &lt; 0) {</span>
<span class="nc" id="L4036">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4037">                return null;</span>
            }

<span class="pc bpc" id="L4040" title="1 of 2 branches missed.">            if (negative) {</span>
<span class="nc" id="L4041">                millis = -millis;</span>
            }

<span class="fc" id="L4044">            dateVal = new java.util.Date(millis);</span>
<span class="fc" id="L4045">        } else {</span>
<span class="nc" id="L4046">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4047">            return null;</span>
        }

<span class="fc bfc" id="L4050" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L4051">            bp += offset;</span>
<span class="fc" id="L4052">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L4053">            matchStat = VALUE;</span>
<span class="fc" id="L4054">            return dateVal;</span>
        }

<span class="pc bpc" id="L4057" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L4058">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L4059" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L4060">                token = JSONToken.COMMA;</span>
<span class="nc" id="L4061">                bp += offset;</span>
<span class="nc" id="L4062">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4063" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L4064">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L4065">                bp += offset;</span>
<span class="nc" id="L4066">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4067" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L4068">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L4069">                bp += offset;</span>
<span class="nc" id="L4070">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4071" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L4072">                token = JSONToken.EOF;</span>
<span class="fc" id="L4073">                bp += (offset - 1);</span>
<span class="fc" id="L4074">                ch = EOI;</span>
            } else {
<span class="nc" id="L4076">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4077">                return null;</span>
            }
<span class="fc" id="L4079">            matchStat = END;</span>
        } else {
<span class="nc" id="L4081">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4082">            return null;</span>
        }

<span class="fc" id="L4085">        return dateVal;</span>
    }

    public java.util.Date scanDate(char seperator) {
<span class="fc" id="L4089">        matchStat = UNKNOWN;</span>

<span class="fc" id="L4091">        int offset = 0;</span>
<span class="fc" id="L4092">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.Date dateVal;
<span class="fc bfc" id="L4095" title="All 2 branches covered.">        if (chLocal == '&quot;'){</span>
<span class="fc" id="L4096">            int startIndex = bp + 1;</span>
<span class="fc" id="L4097">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="pc bpc" id="L4098" title="1 of 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L4099">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L4102">            int startIndex2 = bp + 1; // must re compute</span>
<span class="fc" id="L4103">            String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="pc bpc" id="L4104" title="1 of 2 branches missed.">            if (stringVal.indexOf('\\') != -1) {</span>
                for (;;) {
<span class="nc" id="L4106">                    int slashCount = 0;</span>
<span class="nc bnc" id="L4107" title="All 2 branches missed.">                    for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="nc bnc" id="L4108" title="All 2 branches missed.">                        if (charAt(i) == '\\') {</span>
<span class="nc" id="L4109">                            slashCount++;</span>
                        } else {
                            break;
                        }
                    }
<span class="nc bnc" id="L4114" title="All 2 branches missed.">                    if (slashCount % 2 == 0) {</span>
<span class="nc" id="L4115">                        break;</span>
                    }
<span class="nc" id="L4117">                    endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="nc" id="L4118">                }</span>

<span class="nc" id="L4120">                int chars_len = endIndex - (bp + 1);</span>
<span class="nc" id="L4121">                char[] chars = sub_chars( bp + 1, chars_len);</span>

<span class="nc" id="L4123">                stringVal = readString(chars, chars_len);</span>
            }

<span class="fc" id="L4126">            offset += (endIndex - (bp + 1) + 1);</span>
<span class="fc" id="L4127">            chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L4129">            JSONScanner dateLexer = new JSONScanner(stringVal);</span>
            try {
<span class="pc bpc" id="L4131" title="1 of 2 branches missed.">                if (dateLexer.scanISO8601DateIfMatch(false)) {</span>
<span class="fc" id="L4132">                    Calendar calendar = dateLexer.getCalendar();</span>
<span class="fc" id="L4133">                    dateVal = calendar.getTime();</span>
<span class="fc" id="L4134">                } else {</span>
<span class="nc" id="L4135">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L4136">                    return null;</span>
                }
            } finally {
<span class="fc" id="L4139">                dateLexer.close();</span>
            }
<span class="pc bpc" id="L4141" title="2 of 6 branches missed.">        } else if (chLocal == '-' || (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9')) {</span>
<span class="fc" id="L4142">            long millis = 0;</span>

<span class="fc" id="L4144">            boolean negative = false;</span>
<span class="pc bpc" id="L4145" title="1 of 2 branches missed.">            if (chLocal == '-') {</span>
<span class="nc" id="L4146">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L4147">                negative = true;</span>
            }

<span class="pc bpc" id="L4150" title="2 of 4 branches missed.">            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L4151">                millis = chLocal - '0';</span>
                for (; ; ) {
<span class="fc" id="L4153">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L4154" title="All 4 branches covered.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L4155">                        millis = millis * 10 + (chLocal - '0');</span>
                    } else {
                        break;
                    }
                }
            }

<span class="pc bpc" id="L4162" title="1 of 2 branches missed.">            if (millis &lt; 0) {</span>
<span class="nc" id="L4163">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4164">                return null;</span>
            }

<span class="pc bpc" id="L4167" title="1 of 2 branches missed.">            if (negative) {</span>
<span class="nc" id="L4168">                millis = -millis;</span>
            }

<span class="fc" id="L4171">            dateVal = new java.util.Date(millis);</span>
<span class="pc bpc" id="L4172" title="1 of 2 branches missed.">        } else if (chLocal == 'n' &amp;&amp;</span>
<span class="pc bpc" id="L4173" title="1 of 2 branches missed.">                   charAt(bp + offset) == 'u' &amp;&amp;</span>
<span class="pc bpc" id="L4174" title="1 of 2 branches missed.">                   charAt(bp + offset + 1) == 'l' &amp;&amp;</span>
<span class="pc bpc" id="L4175" title="1 of 2 branches missed.">                   charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L4176">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L4177">            dateVal = null;</span>
<span class="fc" id="L4178">            offset += 3;</span>
<span class="fc" id="L4179">            chLocal = charAt(bp + offset++);</span>
        } else {
<span class="nc" id="L4181">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4182">            return null;</span>
        }

<span class="fc bfc" id="L4185" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L4186">            bp += offset;</span>
<span class="fc" id="L4187">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L4188">            matchStat = VALUE;</span>
<span class="fc" id="L4189">            token = JSONToken.COMMA;</span>
<span class="fc" id="L4190">            return dateVal;</span>
        }

<span class="pc bpc" id="L4193" title="1 of 2 branches missed.">        if (chLocal == ']') {</span>
<span class="fc" id="L4194">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L4195" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L4196">                token = JSONToken.COMMA;</span>
<span class="nc" id="L4197">                bp += offset;</span>
<span class="nc" id="L4198">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4199" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L4200">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L4201">                bp += offset;</span>
<span class="nc" id="L4202">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4203" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L4204">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L4205">                bp += offset;</span>
<span class="nc" id="L4206">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4207" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L4208">                token = JSONToken.EOF;</span>
<span class="fc" id="L4209">                bp += (offset - 1);</span>
<span class="fc" id="L4210">                ch = EOI;</span>
            } else {
<span class="nc" id="L4212">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4213">                return null;</span>
            }
<span class="fc" id="L4215">            matchStat = END;</span>
        } else {
<span class="nc" id="L4217">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4218">            return null;</span>
        }

<span class="fc" id="L4221">        return dateVal;</span>
    }

    public java.util.UUID scanFieldUUID(char[] fieldName) {
<span class="fc" id="L4225">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L4227" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L4228">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L4229">            return null;</span>
        }

        // int index = bp + fieldName.length;

<span class="fc" id="L4234">        int offset = fieldName.length;</span>
<span class="fc" id="L4235">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.UUID uuid;
<span class="fc bfc" id="L4238" title="All 2 branches covered.">        if (chLocal == '&quot;') {</span>
<span class="fc" id="L4239">            int startIndex = bp + fieldName.length + 1;</span>
<span class="fc" id="L4240">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="pc bpc" id="L4241" title="1 of 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L4242">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L4245">            int startIndex2 = bp + fieldName.length + 1; // must re compute</span>
<span class="fc" id="L4246">            int len = endIndex - startIndex2;</span>
<span class="fc bfc" id="L4247" title="All 2 branches covered.">            if (len == 36) {</span>
<span class="fc" id="L4248">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="fc bfc" id="L4249" title="All 2 branches covered.">                for (int i = 0; i &lt; 8; ++i) {</span>
<span class="fc" id="L4250">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4252" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4253">                        num = ch - '0';</span>
<span class="pc bpc" id="L4254" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4255">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4256" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4257">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4259">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4260">                        return null;</span>
                    }

<span class="fc" id="L4263">                    mostSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4264">                    mostSigBits |= num;</span>
                }
<span class="fc bfc" id="L4266" title="All 2 branches covered.">                for (int i = 9; i &lt; 13; ++i) {</span>
<span class="fc" id="L4267">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4269" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4270">                        num = ch - '0';</span>
<span class="pc bpc" id="L4271" title="1 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4272">                        num = 10 + (ch - 'a');</span>
<span class="pc bpc" id="L4273" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="fc" id="L4274">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4276">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4277">                        return null;</span>
                    }

<span class="fc" id="L4280">                    mostSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4281">                    mostSigBits |= num;</span>
                }
<span class="fc bfc" id="L4283" title="All 2 branches covered.">                for (int i = 14; i &lt; 18; ++i) {</span>
<span class="fc" id="L4284">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4286" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4287">                        num = ch - '0';</span>
<span class="pc bpc" id="L4288" title="1 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4289">                        num = 10 + (ch - 'a');</span>
<span class="pc bpc" id="L4290" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="fc" id="L4291">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4293">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4294">                        return null;</span>
                    }

<span class="fc" id="L4297">                    mostSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4298">                    mostSigBits |= num;</span>
                }
<span class="fc bfc" id="L4300" title="All 2 branches covered.">                for (int i = 19; i &lt; 23; ++i) {</span>
<span class="fc" id="L4301">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4303" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4304">                        num = ch - '0';</span>
<span class="pc bpc" id="L4305" title="1 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4306">                        num = 10 + (ch - 'a');</span>
<span class="pc bpc" id="L4307" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="fc" id="L4308">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4310">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4311">                        return null;</span>
                    }

<span class="fc" id="L4314">                    leastSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4315">                    leastSigBits |= num;</span>
                }
<span class="fc bfc" id="L4317" title="All 2 branches covered.">                for (int i = 24; i &lt; 36; ++i) {</span>
<span class="fc" id="L4318">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4320" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4321">                        num = ch - '0';</span>
<span class="pc bpc" id="L4322" title="1 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4323">                        num = 10 + (ch - 'a');</span>
<span class="pc bpc" id="L4324" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="fc" id="L4325">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4327">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4328">                        return null;</span>
                    }

<span class="fc" id="L4331">                    leastSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4332">                    leastSigBits |= num;</span>
                }
<span class="fc" id="L4334">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="fc" id="L4336">                offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="fc" id="L4337">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L4338" title="1 of 2 branches missed.">            } else if (len == 32) {</span>
<span class="nc" id="L4339">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="nc bnc" id="L4340" title="All 2 branches missed.">                for (int i = 0; i &lt; 16; ++i) {</span>
<span class="nc" id="L4341">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4343" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4344">                        num = ch - '0';</span>
<span class="nc bnc" id="L4345" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4346">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4347" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4348">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4350">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4351">                        return null;</span>
                    }

<span class="nc" id="L4354">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4355">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4357" title="All 2 branches missed.">                for (int i = 16; i &lt; 32; ++i) {</span>
<span class="nc" id="L4358">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4360" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4361">                        num = ch - '0';</span>
<span class="nc bnc" id="L4362" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4363">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4364" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4365">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4367">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4368">                        return null;</span>
                    }

<span class="nc" id="L4371">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4372">                    leastSigBits |= num;</span>
                }

<span class="nc" id="L4375">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="nc" id="L4377">                offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="nc" id="L4378">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L4379">            } else {</span>
<span class="fc" id="L4380">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L4381">                return null;</span>
            }
<span class="pc bpc" id="L4383" title="1 of 2 branches missed.">        } else if (chLocal == 'n'</span>
<span class="pc bpc" id="L4384" title="1 of 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'u'</span>
<span class="pc bpc" id="L4385" title="1 of 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l'</span>
<span class="pc bpc" id="L4386" title="1 of 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l') {</span>
<span class="fc" id="L4387">            uuid = null;</span>
<span class="fc" id="L4388">            chLocal = charAt(bp + (offset++));</span>
        } else {
<span class="nc" id="L4390">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4391">            return null;</span>
        }

<span class="pc bpc" id="L4394" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L4395">            bp += offset;</span>
<span class="nc" id="L4396">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L4397">            matchStat = VALUE;</span>
<span class="nc" id="L4398">            return uuid;</span>
        }

<span class="pc bpc" id="L4401" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L4402">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L4403" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L4404">                token = JSONToken.COMMA;</span>
<span class="nc" id="L4405">                bp += offset;</span>
<span class="nc" id="L4406">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4407" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L4408">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L4409">                bp += offset;</span>
<span class="nc" id="L4410">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4411" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L4412">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L4413">                bp += offset;</span>
<span class="nc" id="L4414">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4415" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L4416">                token = JSONToken.EOF;</span>
<span class="fc" id="L4417">                bp += (offset - 1);</span>
<span class="fc" id="L4418">                ch = EOI;</span>
            } else {
<span class="nc" id="L4420">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4421">                return null;</span>
            }
<span class="fc" id="L4423">            matchStat = END;</span>
        } else {
<span class="nc" id="L4425">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4426">            return null;</span>
        }

<span class="fc" id="L4429">        return uuid;</span>
    }

    public java.util.UUID scanUUID(char seperator) {
<span class="nc" id="L4433">        matchStat = UNKNOWN;</span>

        // int index = bp + fieldName.length;

<span class="nc" id="L4437">        int offset = 0;</span>
<span class="nc" id="L4438">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.UUID uuid;
<span class="nc bnc" id="L4441" title="All 2 branches missed.">        if (chLocal == '&quot;') {</span>
<span class="nc" id="L4442">            int startIndex = bp + 1;</span>
<span class="nc" id="L4443">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="nc bnc" id="L4444" title="All 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L4445">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="nc" id="L4448">            int startIndex2 = bp + 1; // must re compute</span>
<span class="nc" id="L4449">            int len = endIndex - startIndex2;</span>
<span class="nc bnc" id="L4450" title="All 2 branches missed.">            if (len == 36) {</span>
<span class="nc" id="L4451">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="nc bnc" id="L4452" title="All 2 branches missed.">                for (int i = 0; i &lt; 8; ++i) {</span>
<span class="nc" id="L4453">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4455" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4456">                        num = ch - '0';</span>
<span class="nc bnc" id="L4457" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4458">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4459" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4460">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4462">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4463">                        return null;</span>
                    }

<span class="nc" id="L4466">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4467">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4469" title="All 2 branches missed.">                for (int i = 9; i &lt; 13; ++i) {</span>
<span class="nc" id="L4470">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4472" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4473">                        num = ch - '0';</span>
<span class="nc bnc" id="L4474" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4475">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4476" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4477">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4479">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4480">                        return null;</span>
                    }

<span class="nc" id="L4483">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4484">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4486" title="All 2 branches missed.">                for (int i = 14; i &lt; 18; ++i) {</span>
<span class="nc" id="L4487">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4489" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4490">                        num = ch - '0';</span>
<span class="nc bnc" id="L4491" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4492">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4493" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4494">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4496">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4497">                        return null;</span>
                    }

<span class="nc" id="L4500">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4501">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4503" title="All 2 branches missed.">                for (int i = 19; i &lt; 23; ++i) {</span>
<span class="nc" id="L4504">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4506" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4507">                        num = ch - '0';</span>
<span class="nc bnc" id="L4508" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4509">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4510" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4511">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4513">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4514">                        return null;</span>
                    }

<span class="nc" id="L4517">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4518">                    leastSigBits |= num;</span>
                }
<span class="nc bnc" id="L4520" title="All 2 branches missed.">                for (int i = 24; i &lt; 36; ++i) {</span>
<span class="nc" id="L4521">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4523" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4524">                        num = ch - '0';</span>
<span class="nc bnc" id="L4525" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4526">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4527" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4528">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4530">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4531">                        return null;</span>
                    }

<span class="nc" id="L4534">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4535">                    leastSigBits |= num;</span>
                }
<span class="nc" id="L4537">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="nc" id="L4539">                offset += (endIndex - (bp + 1) + 1);</span>
<span class="nc" id="L4540">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L4541" title="All 2 branches missed.">            } else if (len == 32) {</span>
<span class="nc" id="L4542">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="nc bnc" id="L4543" title="All 2 branches missed.">                for (int i = 0; i &lt; 16; ++i) {</span>
<span class="nc" id="L4544">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4546" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4547">                        num = ch - '0';</span>
<span class="nc bnc" id="L4548" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4549">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4550" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4551">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4553">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4554">                        return null;</span>
                    }

<span class="nc" id="L4557">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4558">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4560" title="All 2 branches missed.">                for (int i = 16; i &lt; 32; ++i) {</span>
<span class="nc" id="L4561">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4563" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4564">                        num = ch - '0';</span>
<span class="nc bnc" id="L4565" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4566">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4567" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4568">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4570">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4571">                        return null;</span>
                    }

<span class="nc" id="L4574">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4575">                    leastSigBits |= num;</span>
                }

<span class="nc" id="L4578">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="nc" id="L4580">                offset += (endIndex - (bp + 1) + 1);</span>
<span class="nc" id="L4581">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L4582">            } else {</span>
<span class="nc" id="L4583">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4584">                return null;</span>
            }
<span class="nc bnc" id="L4586" title="All 2 branches missed.">        } else if (chLocal == 'n'</span>
<span class="nc bnc" id="L4587" title="All 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'u'</span>
<span class="nc bnc" id="L4588" title="All 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l'</span>
<span class="nc bnc" id="L4589" title="All 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l') {</span>
<span class="nc" id="L4590">            uuid = null;</span>
<span class="nc" id="L4591">            chLocal = charAt(bp + (offset++));</span>
        } else {
<span class="nc" id="L4593">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4594">            return null;</span>
        }

<span class="nc bnc" id="L4597" title="All 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L4598">            bp += offset;</span>
<span class="nc" id="L4599">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L4600">            matchStat = VALUE;</span>
<span class="nc" id="L4601">            return uuid;</span>
        }

<span class="nc bnc" id="L4604" title="All 2 branches missed.">        if (chLocal == ']') {</span>
<span class="nc" id="L4605">            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L4606" title="All 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L4607">                token = JSONToken.COMMA;</span>
<span class="nc" id="L4608">                bp += offset;</span>
<span class="nc" id="L4609">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L4610" title="All 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L4611">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L4612">                bp += offset;</span>
<span class="nc" id="L4613">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L4614" title="All 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L4615">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L4616">                bp += offset;</span>
<span class="nc" id="L4617">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L4618" title="All 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="nc" id="L4619">                token = JSONToken.EOF;</span>
<span class="nc" id="L4620">                bp += (offset - 1);</span>
<span class="nc" id="L4621">                ch = EOI;</span>
            } else {
<span class="nc" id="L4623">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4624">                return null;</span>
            }
<span class="nc" id="L4626">            matchStat = END;</span>
        } else {
<span class="nc" id="L4628">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4629">            return null;</span>
        }

<span class="nc" id="L4632">        return uuid;</span>
    }

    public final void scanTrue() {
<span class="fc bfc" id="L4636" title="All 2 branches covered.">        if (ch != 't') {</span>
<span class="fc" id="L4637">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4639">        next();</span>

<span class="fc bfc" id="L4641" title="All 2 branches covered.">        if (ch != 'r') {</span>
<span class="fc" id="L4642">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4644">        next();</span>

<span class="fc bfc" id="L4646" title="All 2 branches covered.">        if (ch != 'u') {</span>
<span class="fc" id="L4647">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4649">        next();</span>

<span class="fc bfc" id="L4651" title="All 2 branches covered.">        if (ch != 'e') {</span>
<span class="fc" id="L4652">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4654">        next();</span>

<span class="pc bpc" id="L4656" title="1 of 24 branches missed.">        if (ch == ' '  ||</span>
            ch == ','  ||
            ch == '}'  ||
            ch == ']'  ||
            ch == '\n' ||
            ch == '\r' ||
            ch == '\t' ||
            ch == EOI  ||
            ch == '\f' ||
            ch == '\b' ||
            ch == ':'  ||
            ch == '/') {
<span class="fc" id="L4668">            token = JSONToken.TRUE;</span>
        } else {
<span class="fc" id="L4670">            throw new JSONException(&quot;scan true error&quot;);</span>
        }
<span class="fc" id="L4672">    }</span>

    public final void scanNullOrNew() {
<span class="fc" id="L4675">        scanNullOrNew(true);</span>
<span class="fc" id="L4676">    }</span>

    public final void scanNullOrNew(boolean acceptColon) {
<span class="fc bfc" id="L4679" title="All 2 branches covered.">        if (ch != 'n') {</span>
<span class="fc" id="L4680">            throw new JSONException(&quot;error parse null or new&quot;);</span>
        }
<span class="fc" id="L4682">        next();</span>

<span class="fc bfc" id="L4684" title="All 2 branches covered.">        if (ch == 'u') {</span>
<span class="fc" id="L4685">            next();</span>
<span class="fc bfc" id="L4686" title="All 2 branches covered.">            if (ch != 'l') {</span>
<span class="fc" id="L4687">                throw new JSONException(&quot;error parse null&quot;);</span>
            }
<span class="fc" id="L4689">            next();</span>

<span class="fc bfc" id="L4691" title="All 2 branches covered.">            if (ch != 'l') {</span>
<span class="fc" id="L4692">                throw new JSONException(&quot;error parse null&quot;);</span>
            }
<span class="fc" id="L4694">            next();</span>


<span class="pc bpc" id="L4697" title="1 of 24 branches missed.">            if (ch == ' '</span>
                    || ch == ','
                    || ch == '}'
                    || ch == ']'
                    || ch == '\n'
                    || ch == '\r'
                    || ch == '\t'
                    || ch == EOI
                    || (ch == ':' &amp;&amp; acceptColon)
                    || ch == '\f'
                    || ch == '\b') {

<span class="fc" id="L4709">                token = JSONToken.NULL;</span>
            } else {
<span class="fc" id="L4711">                throw new JSONException(&quot;scan null error&quot;);</span>
            }
<span class="fc" id="L4713">            return;</span>
        }

<span class="fc bfc" id="L4716" title="All 2 branches covered.">        if (ch != 'e') {</span>
<span class="fc" id="L4717">            throw new JSONException(&quot;error parse new&quot;);</span>
        }
<span class="fc" id="L4719">        next();</span>

<span class="fc bfc" id="L4721" title="All 2 branches covered.">        if (ch != 'w') {</span>
<span class="fc" id="L4722">            throw new JSONException(&quot;error parse new&quot;);</span>
        }
<span class="fc" id="L4724">        next();</span>

<span class="fc bfc" id="L4726" title="All 20 branches covered.">        if (ch == ' '  ||</span>
            ch == ','  ||
            ch == '}'  ||
            ch == ']'  ||
            ch == '\n' ||
            ch == '\r' ||
            ch == '\t' ||
            ch == EOI  ||
            ch == '\f' ||
            ch == '\b') {
<span class="fc" id="L4736">            token = JSONToken.NEW;</span>
        } else {
<span class="fc" id="L4738">            throw new JSONException(&quot;scan new error&quot;);</span>
        }
<span class="fc" id="L4740">    }</span>

    public final void scanFalse() {
<span class="fc bfc" id="L4743" title="All 2 branches covered.">        if (ch != 'f') {</span>
<span class="fc" id="L4744">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4746">        next();</span>

<span class="fc bfc" id="L4748" title="All 2 branches covered.">        if (ch != 'a') {</span>
<span class="fc" id="L4749">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4751">        next();</span>

<span class="fc bfc" id="L4753" title="All 2 branches covered.">        if (ch != 'l') {</span>
<span class="fc" id="L4754">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4756">        next();</span>

<span class="fc bfc" id="L4758" title="All 2 branches covered.">        if (ch != 's') {</span>
<span class="fc" id="L4759">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4761">        next();</span>

<span class="fc bfc" id="L4763" title="All 2 branches covered.">        if (ch != 'e') {</span>
<span class="fc" id="L4764">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4766">        next();</span>

<span class="pc bpc" id="L4768" title="1 of 24 branches missed.">        if (ch == ' '  ||</span>
            ch == ','  ||
            ch == '}'  ||
            ch == ']'  ||
            ch == '\n' ||
            ch == '\r' ||
            ch == '\t' ||
            ch == EOI  ||
            ch == '\f' ||
            ch == '\b' ||
            ch == ':'  ||
            ch == '/') {
<span class="fc" id="L4780">            token = JSONToken.FALSE;</span>
        } else {
<span class="fc" id="L4782">            throw new JSONException(&quot;scan false error&quot;);</span>
        }
<span class="fc" id="L4784">    }</span>

    public final void scanIdent() {
<span class="fc" id="L4787">        np = bp - 1;</span>
<span class="fc" id="L4788">        hasSpecial = false;</span>

        for (;;) {
<span class="fc" id="L4791">            sp++;</span>

<span class="fc" id="L4793">            next();</span>
<span class="fc bfc" id="L4794" title="All 2 branches covered.">            if (Character.isLetterOrDigit(ch)) {</span>
<span class="fc" id="L4795">                continue;</span>
            }

<span class="fc" id="L4798">            String ident = stringVal();</span>

<span class="fc bfc" id="L4800" title="All 2 branches covered.">            if (&quot;null&quot;.equalsIgnoreCase(ident)) {</span>
<span class="fc" id="L4801">                token = JSONToken.NULL;</span>
<span class="fc bfc" id="L4802" title="All 2 branches covered.">            } else if (&quot;new&quot;.equals(ident)) {</span>
<span class="fc" id="L4803">                token = JSONToken.NEW;</span>
<span class="fc bfc" id="L4804" title="All 2 branches covered.">            } else if (&quot;true&quot;.equals(ident)) {</span>
<span class="fc" id="L4805">                token = JSONToken.TRUE;</span>
<span class="fc bfc" id="L4806" title="All 2 branches covered.">            } else if (&quot;false&quot;.equals(ident)) {</span>
<span class="fc" id="L4807">                token = JSONToken.FALSE;</span>
<span class="fc bfc" id="L4808" title="All 2 branches covered.">            } else if (&quot;undefined&quot;.equals(ident)) {</span>
<span class="fc" id="L4809">                token = JSONToken.UNDEFINED;</span>
<span class="fc bfc" id="L4810" title="All 2 branches covered.">            } else if (&quot;Set&quot;.equals(ident)) {</span>
<span class="fc" id="L4811">                token = JSONToken.SET;</span>
<span class="fc bfc" id="L4812" title="All 2 branches covered.">            } else if (&quot;TreeSet&quot;.equals(ident)) {</span>
<span class="fc" id="L4813">                token = JSONToken.TREE_SET;</span>
            } else {
<span class="fc" id="L4815">                token = JSONToken.IDENTIFIER;</span>
            }
<span class="fc" id="L4817">            return;</span>
        }
    }

    public abstract String stringVal();

    public abstract String subString(int offset, int count);

    protected abstract char[] sub_chars(int offset, int count);

    public static String readString(char[] chars, int chars_len) {
<span class="fc" id="L4828">        char[] sbuf = new char[chars_len];</span>
<span class="fc" id="L4829">        int len = 0;</span>
<span class="fc bfc" id="L4830" title="All 2 branches covered.">        for (int i = 0; i &lt; chars_len; ++i) {</span>
<span class="fc" id="L4831">            char ch = chars[i];</span>

<span class="fc bfc" id="L4833" title="All 2 branches covered.">            if (ch != '\\') {</span>
<span class="fc" id="L4834">                sbuf[len++] = ch;</span>
<span class="fc" id="L4835">                continue;</span>
            }
<span class="fc" id="L4837">            ch = chars[++i];</span>

<span class="fc bfc" id="L4839" title="All 21 branches covered.">            switch (ch) {</span>
                case '0':
<span class="fc" id="L4841">                    sbuf[len++] = '\0';</span>
<span class="fc" id="L4842">                    break;</span>
                case '1':
<span class="fc" id="L4844">                    sbuf[len++] = '\1';</span>
<span class="fc" id="L4845">                    break;</span>
                case '2':
<span class="fc" id="L4847">                    sbuf[len++] = '\2';</span>
<span class="fc" id="L4848">                    break;</span>
                case '3':
<span class="fc" id="L4850">                    sbuf[len++] = '\3';</span>
<span class="fc" id="L4851">                    break;</span>
                case '4':
<span class="fc" id="L4853">                    sbuf[len++] = '\4';</span>
<span class="fc" id="L4854">                    break;</span>
                case '5':
<span class="fc" id="L4856">                    sbuf[len++] = '\5';</span>
<span class="fc" id="L4857">                    break;</span>
                case '6':
<span class="fc" id="L4859">                    sbuf[len++] = '\6';</span>
<span class="fc" id="L4860">                    break;</span>
                case '7':
<span class="fc" id="L4862">                    sbuf[len++] = '\7';</span>
<span class="fc" id="L4863">                    break;</span>
                case 'b': // 8
<span class="fc" id="L4865">                    sbuf[len++] = '\b';</span>
<span class="fc" id="L4866">                    break;</span>
                case 't': // 9
<span class="fc" id="L4868">                    sbuf[len++] = '\t';</span>
<span class="fc" id="L4869">                    break;</span>
                case 'n': // 10
<span class="fc" id="L4871">                    sbuf[len++] = '\n';</span>
<span class="fc" id="L4872">                    break;</span>
                case 'v': // 11
<span class="fc" id="L4874">                    sbuf[len++] = '\u000B';</span>
<span class="fc" id="L4875">                    break;</span>
                case 'f': // 12
                case 'F':
<span class="fc" id="L4878">                    sbuf[len++] = '\f';</span>
<span class="fc" id="L4879">                    break;</span>
                case 'r': // 13
<span class="fc" id="L4881">                    sbuf[len++] = '\r';</span>
<span class="fc" id="L4882">                    break;</span>
                case '&quot;': // 34
<span class="fc" id="L4884">                    sbuf[len++] = '&quot;';</span>
<span class="fc" id="L4885">                    break;</span>
                case '\'': // 39
<span class="fc" id="L4887">                    sbuf[len++] = '\'';</span>
<span class="fc" id="L4888">                    break;</span>
                case '/': // 47
<span class="fc" id="L4890">                    sbuf[len++] = '/';</span>
<span class="fc" id="L4891">                    break;</span>
                case '\\': // 92
<span class="fc" id="L4893">                    sbuf[len++] = '\\';</span>
<span class="fc" id="L4894">                    break;</span>
                case 'x':
<span class="fc" id="L4896">                    sbuf[len++] = (char) (digits[chars[++i]] * 16 + digits[chars[++i]]);</span>
<span class="fc" id="L4897">                    break;</span>
                case 'u':
<span class="fc" id="L4899">                    sbuf[len++] = (char) Integer.parseInt(new String(new char[] { chars[++i], //</span>
                                    chars[++i], //
                                    chars[++i], //
                                    chars[++i] }),
                            16);
<span class="fc" id="L4904">                    break;</span>
                default:
<span class="fc" id="L4906">                    throw new JSONException(&quot;unclosed.str.lit&quot;);</span>
            }
        }
<span class="fc" id="L4909">        return new String(sbuf, 0, len);</span>
    }

    protected abstract boolean charArrayCompare(char[] chars);

    public boolean isBlankInput() {
<span class="fc" id="L4915">        for (int i = 0;; ++i) {</span>
<span class="fc" id="L4916">            char chLocal = charAt(i);</span>
<span class="fc bfc" id="L4917" title="All 2 branches covered.">            if (chLocal == EOI) {</span>
<span class="fc" id="L4918">                token = JSONToken.EOF;</span>
<span class="fc" id="L4919">                break;</span>
            }

<span class="fc bfc" id="L4922" title="All 2 branches covered.">            if (!isWhitespace(chLocal)) {</span>
<span class="fc" id="L4923">                return false;</span>
            }
        }

<span class="fc" id="L4927">        return true;</span>
    }

    public final void skipWhitespace() {
        for (;;) {
<span class="fc bfc" id="L4932" title="All 2 branches covered.">            if (ch &lt;= '/') {</span>
<span class="pc bpc" id="L4933" title="3 of 12 branches missed.">                if (ch == ' '  ||</span>
                    ch == '\r' ||
                    ch == '\n' ||
                    ch == '\t' ||
                    ch == '\f' ||
                    ch == '\b') {
<span class="fc" id="L4939">                    next();</span>
<span class="fc" id="L4940">                    continue;</span>
<span class="fc bfc" id="L4941" title="All 2 branches covered.">                } else if (ch == '/') {</span>
<span class="fc" id="L4942">                    skipComment();</span>
<span class="fc" id="L4943">                    continue;</span>
                } else {
                    break;
                }
            } else {
                break;
            }
        }
<span class="fc" id="L4951">    }</span>

    private void scanStringSingleQuote() {
<span class="fc" id="L4954">        np = bp;</span>
<span class="fc" id="L4955">        hasSpecial = false;</span>
        char chLocal;
        for (;;) {
<span class="fc" id="L4958">            chLocal = next();</span>

<span class="fc bfc" id="L4960" title="All 2 branches covered.">            if (chLocal == '\'') {</span>
<span class="fc" id="L4961">                break;</span>
            }

<span class="fc bfc" id="L4964" title="All 2 branches covered.">            if (chLocal == EOI) {</span>
<span class="fc bfc" id="L4965" title="All 2 branches covered.">                if (!isEOF()) {</span>
<span class="fc" id="L4966">                    putChar((char) EOI);</span>
<span class="fc" id="L4967">                    continue;</span>
                }
<span class="fc" id="L4969">                throw new JSONException(&quot;unclosed single-quote string&quot;);</span>
            }

<span class="fc bfc" id="L4972" title="All 2 branches covered.">            if (chLocal == '\\') {</span>
<span class="fc bfc" id="L4973" title="All 2 branches covered.">                if (!hasSpecial) {</span>
<span class="fc" id="L4974">                    hasSpecial = true;</span>

<span class="pc bpc" id="L4976" title="1 of 2 branches missed.">                    if (sp &gt; sbuf.length) {</span>
<span class="nc" id="L4977">                        char[] newsbuf = new char[sp * 2];</span>
<span class="nc" id="L4978">                        System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="nc" id="L4979">                        sbuf = newsbuf;</span>
                    }

                    // text.getChars(offset, offset + count, dest, 0);
<span class="fc" id="L4983">                    this.copyTo(np + 1, sp, sbuf);</span>
                    // System.arraycopy(buf, np + 1, sbuf, 0, sp);
                }

<span class="fc" id="L4987">                chLocal = next();</span>

<span class="fc bfc" id="L4989" title="All 21 branches covered.">                switch (chLocal) {</span>
                    case '0':
<span class="fc" id="L4991">                        putChar('\0');</span>
<span class="fc" id="L4992">                        break;</span>
                    case '1':
<span class="fc" id="L4994">                        putChar('\1');</span>
<span class="fc" id="L4995">                        break;</span>
                    case '2':
<span class="fc" id="L4997">                        putChar('\2');</span>
<span class="fc" id="L4998">                        break;</span>
                    case '3':
<span class="fc" id="L5000">                        putChar('\3');</span>
<span class="fc" id="L5001">                        break;</span>
                    case '4':
<span class="fc" id="L5003">                        putChar('\4');</span>
<span class="fc" id="L5004">                        break;</span>
                    case '5':
<span class="fc" id="L5006">                        putChar('\5');</span>
<span class="fc" id="L5007">                        break;</span>
                    case '6':
<span class="fc" id="L5009">                        putChar('\6');</span>
<span class="fc" id="L5010">                        break;</span>
                    case '7':
<span class="fc" id="L5012">                        putChar('\7');</span>
<span class="fc" id="L5013">                        break;</span>
                    case 'b': // 8
<span class="fc" id="L5015">                        putChar('\b');</span>
<span class="fc" id="L5016">                        break;</span>
                    case 't': // 9
<span class="fc" id="L5018">                        putChar('\t');</span>
<span class="fc" id="L5019">                        break;</span>
                    case 'n': // 10
<span class="fc" id="L5021">                        putChar('\n');</span>
<span class="fc" id="L5022">                        break;</span>
                    case 'v': // 11
<span class="fc" id="L5024">                        putChar('\u000B');</span>
<span class="fc" id="L5025">                        break;</span>
                    case 'f': // 12
                    case 'F':
<span class="fc" id="L5028">                        putChar('\f');</span>
<span class="fc" id="L5029">                        break;</span>
                    case 'r': // 13
<span class="fc" id="L5031">                        putChar('\r');</span>
<span class="fc" id="L5032">                        break;</span>
                    case '&quot;': // 34
<span class="fc" id="L5034">                        putChar('&quot;');</span>
<span class="fc" id="L5035">                        break;</span>
                    case '\'': // 39
<span class="fc" id="L5037">                        putChar('\'');</span>
<span class="fc" id="L5038">                        break;</span>
                    case '/': // 47
<span class="fc" id="L5040">                        putChar('/');</span>
<span class="fc" id="L5041">                        break;</span>
                    case '\\': // 92
<span class="fc" id="L5043">                        putChar('\\');</span>
<span class="fc" id="L5044">                        break;</span>
                    case 'x':
<span class="fc" id="L5046">                        char x1 = next();</span>
<span class="fc" id="L5047">                        char x2 = next();</span>

<span class="pc bpc" id="L5049" title="2 of 12 branches missed.">                        boolean hex1 = (x1 &gt;= '0' &amp;&amp; x1 &lt;= '9')</span>
                                || (x1 &gt;= 'a' &amp;&amp; x1 &lt;= 'f')
                                || (x1 &gt;= 'A' &amp;&amp; x1 &lt;= 'F');
<span class="pc bpc" id="L5052" title="7 of 12 branches missed.">                        boolean hex2 = (x2 &gt;= '0' &amp;&amp; x2 &lt;= '9')</span>
                                || (x2 &gt;= 'a' &amp;&amp; x2 &lt;= 'f')
                                || (x2 &gt;= 'A' &amp;&amp; x2 &lt;= 'F');
<span class="fc bfc" id="L5055" title="All 4 branches covered.">                        if (!hex1 || !hex2) {</span>
<span class="fc" id="L5056">                            throw new JSONException(&quot;invalid escape character \\x&quot; + x1 + x2);</span>
                        }

<span class="fc" id="L5059">                        putChar((char) (digits[x1] * 16 + digits[x2]));</span>
<span class="fc" id="L5060">                        break;</span>
                    case 'u':
<span class="fc" id="L5062">                        putChar((char) Integer.parseInt(new String(new char[] { next(), next(), next(), next() }), 16));</span>
<span class="fc" id="L5063">                        break;</span>
                    default:
<span class="fc" id="L5065">                        this.ch = chLocal;</span>
<span class="fc" id="L5066">                        throw new JSONException(&quot;unclosed single-quote string&quot;);</span>
                }
                continue;
            }

<span class="fc bfc" id="L5071" title="All 2 branches covered.">            if (!hasSpecial) {</span>
<span class="fc" id="L5072">                sp++;</span>
<span class="fc" id="L5073">                continue;</span>
            }

<span class="fc bfc" id="L5076" title="All 2 branches covered.">            if (sp == sbuf.length) {</span>
<span class="fc" id="L5077">                putChar(chLocal);</span>
            } else {
<span class="fc" id="L5079">                sbuf[sp++] = chLocal;</span>
            }
        }

<span class="fc" id="L5083">        token = LITERAL_STRING;</span>
<span class="fc" id="L5084">        this.next();</span>
<span class="fc" id="L5085">    }</span>

    /**
     * Append a character to sbuf.
     */
    protected final void putChar(char ch) {
<span class="fc bfc" id="L5091" title="All 2 branches covered.">        if (sp &gt;= sbuf.length) {</span>
<span class="fc" id="L5092">            int len = sbuf.length * 2;</span>
<span class="fc bfc" id="L5093" title="All 2 branches covered.">            if (len &lt; sp) {</span>
<span class="fc" id="L5094">                len = sp + 1;</span>
            }
<span class="fc" id="L5096">            char[] newsbuf = new char[len];</span>
<span class="fc" id="L5097">            System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="fc" id="L5098">            sbuf = newsbuf;</span>
        }
<span class="fc" id="L5100">        sbuf[sp++] = ch;</span>
<span class="fc" id="L5101">    }</span>

    public final void scanHex() {
<span class="pc bpc" id="L5104" title="1 of 2 branches missed.">        if (ch != 'x') {</span>
<span class="nc" id="L5105">            throw new JSONException(&quot;illegal state. &quot; + ch);</span>
        }
<span class="fc" id="L5107">        next();</span>
<span class="pc bpc" id="L5108" title="1 of 2 branches missed.">        if (ch != '\'') {</span>
<span class="nc" id="L5109">            throw new JSONException(&quot;illegal state. &quot; + ch);</span>
        }

<span class="fc" id="L5112">        np = bp;</span>
<span class="fc" id="L5113">        next();</span>

<span class="fc bfc" id="L5115" title="All 2 branches covered.">        if (ch == '\'') {</span>
<span class="fc" id="L5116">            next();</span>
<span class="fc" id="L5117">            token = JSONToken.HEX;</span>
<span class="fc" id="L5118">            return;</span>
        }

<span class="fc" id="L5121">        for (int i = 0;;++i) {</span>
<span class="fc" id="L5122">            char ch = next();</span>
<span class="pc bpc" id="L5123" title="1 of 8 branches missed.">            if ((ch &gt;= '0' &amp;&amp; ch &lt;= '9') || (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F')) {</span>
<span class="fc" id="L5124">                sp++;</span>
<span class="fc" id="L5125">                continue;</span>
<span class="pc bpc" id="L5126" title="1 of 2 branches missed.">            } else if (ch == '\'') {</span>
<span class="fc" id="L5127">                sp++;</span>
<span class="fc" id="L5128">                next();</span>
<span class="fc" id="L5129">                break;</span>
            } else {
<span class="nc" id="L5131">                throw new JSONException(&quot;illegal state. &quot; + ch);</span>
            }
        }
<span class="fc" id="L5134">        token = JSONToken.HEX;</span>
<span class="fc" id="L5135">    }</span>

    public final void scanNumber() {
<span class="fc" id="L5138">        np = bp;</span>

<span class="fc bfc" id="L5140" title="All 2 branches covered.">        if (ch == '-') {</span>
<span class="fc" id="L5141">            sp++;</span>
<span class="fc" id="L5142">            next();</span>
        }

        for (;;) {
<span class="fc bfc" id="L5146" title="All 4 branches covered.">            if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L5147">                sp++;</span>
            } else {
                break;
            }
<span class="fc" id="L5151">            next();</span>
        }

<span class="fc" id="L5154">        boolean isDouble = false;</span>

<span class="fc bfc" id="L5156" title="All 2 branches covered.">        if (ch == '.') {</span>
<span class="fc" id="L5157">            sp++;</span>
<span class="fc" id="L5158">            next();</span>
<span class="fc" id="L5159">            isDouble = true;</span>

            for (;;) {
<span class="fc bfc" id="L5162" title="All 4 branches covered.">                if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L5163">                    sp++;</span>
                } else {
                    break;
                }
<span class="fc" id="L5167">                next();</span>
            }
        }

<span class="pc bpc" id="L5171" title="1 of 2 branches missed.">        if (sp &gt; 65535) {</span>
<span class="nc" id="L5172">            throw new JSONException(&quot;scanNumber overflow&quot;);</span>
        }

<span class="fc bfc" id="L5175" title="All 2 branches covered.">        if (ch == 'L') {</span>
<span class="fc" id="L5176">            sp++;</span>
<span class="fc" id="L5177">            next();</span>
<span class="fc bfc" id="L5178" title="All 2 branches covered.">        } else if (ch == 'S') {</span>
<span class="fc" id="L5179">            sp++;</span>
<span class="fc" id="L5180">            next();</span>
<span class="fc bfc" id="L5181" title="All 2 branches covered.">        } else if (ch == 'B') {</span>
<span class="fc" id="L5182">            sp++;</span>
<span class="fc" id="L5183">            next();</span>
<span class="fc bfc" id="L5184" title="All 2 branches covered.">        } else if (ch == 'F') {</span>
<span class="fc" id="L5185">            sp++;</span>
<span class="fc" id="L5186">            next();</span>
<span class="fc" id="L5187">            isDouble = true;</span>
<span class="fc bfc" id="L5188" title="All 2 branches covered.">        } else if (ch == 'D') {</span>
<span class="fc" id="L5189">            sp++;</span>
<span class="fc" id="L5190">            next();</span>
<span class="fc" id="L5191">            isDouble = true;</span>
<span class="fc bfc" id="L5192" title="All 4 branches covered.">        } else if (ch == 'e' || ch == 'E') {</span>
<span class="fc" id="L5193">            sp++;</span>
<span class="fc" id="L5194">            next();</span>

<span class="fc bfc" id="L5196" title="All 4 branches covered.">            if (ch == '+' || ch == '-') {</span>
<span class="fc" id="L5197">                sp++;</span>
<span class="fc" id="L5198">                next();</span>
            }

            for (;;) {
<span class="fc bfc" id="L5202" title="All 4 branches covered.">                if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L5203">                    sp++;</span>
                } else {
                    break;
                }
<span class="fc" id="L5207">                next();</span>
            }

<span class="fc bfc" id="L5210" title="All 4 branches covered.">            if (ch == 'D' || ch == 'F') {</span>
<span class="fc" id="L5211">                sp++;</span>
<span class="fc" id="L5212">                next();</span>
            }

<span class="fc" id="L5215">            isDouble = true;</span>
        }

<span class="fc bfc" id="L5218" title="All 2 branches covered.">        if (isDouble) {</span>
<span class="fc" id="L5219">            token = JSONToken.LITERAL_FLOAT;</span>
        } else {
<span class="fc" id="L5221">            token = JSONToken.LITERAL_INT;</span>
        }
<span class="fc" id="L5223">    }</span>

    public final long longValue() throws NumberFormatException {
<span class="fc" id="L5226">        long result = 0;</span>
<span class="fc" id="L5227">        boolean negative = false;</span>
        long limit;
        int digit;

<span class="pc bpc" id="L5231" title="1 of 2 branches missed.">        if (np == -1) {</span>
<span class="nc" id="L5232">            np = 0;</span>
        }

<span class="fc" id="L5235">        int i = np, max = np + sp;</span>

<span class="fc bfc" id="L5237" title="All 2 branches covered.">        if (charAt(np) == '-') {</span>
<span class="fc" id="L5238">            negative = true;</span>
<span class="fc" id="L5239">            limit = Long.MIN_VALUE;</span>
<span class="fc" id="L5240">            i++;</span>
        } else {
<span class="fc" id="L5242">            limit = -Long.MAX_VALUE;</span>
        }
<span class="fc" id="L5244">        long multmin = MULTMIN_RADIX_TEN;</span>
<span class="fc bfc" id="L5245" title="All 2 branches covered.">        if (i &lt; max) {</span>
<span class="fc" id="L5246">            digit = charAt(i++) - '0';</span>
<span class="fc" id="L5247">            result = -digit;</span>
        }
<span class="fc bfc" id="L5249" title="All 2 branches covered.">        while (i &lt; max) {</span>
            // Accumulating negatively avoids surprises near MAX_VALUE
<span class="fc" id="L5251">            char chLocal = charAt(i++);</span>

<span class="fc bfc" id="L5253" title="All 6 branches covered.">            if (chLocal == 'L' || chLocal == 'S' || chLocal == 'B') {</span>
<span class="fc" id="L5254">                break;</span>
            }

<span class="fc" id="L5257">            digit = chLocal - '0';</span>
<span class="fc bfc" id="L5258" title="All 2 branches covered.">            if (result &lt; multmin) {</span>
<span class="fc" id="L5259">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L5261">            result *= 10;</span>
<span class="fc bfc" id="L5262" title="All 2 branches covered.">            if (result &lt; limit + digit) {</span>
<span class="fc" id="L5263">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L5265">            result -= digit;</span>
<span class="fc" id="L5266">        }</span>

<span class="fc bfc" id="L5268" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc bfc" id="L5269" title="All 2 branches covered.">            if (i &gt; np + 1) {</span>
<span class="fc" id="L5270">                return result;</span>
            } else { /* Only got &quot;-&quot; */
<span class="fc" id="L5272">                throw new NumberFormatException(numberString());</span>
            }
        } else {
<span class="fc" id="L5275">            return -result;</span>
        }
    }

    public final Number decimalValue(boolean decimal) {
<span class="fc" id="L5280">        char chLocal = charAt(np + sp - 1);</span>
        try {
<span class="fc bfc" id="L5282" title="All 2 branches covered.">            if (chLocal == 'F') {</span>
<span class="fc" id="L5283">                return Float.parseFloat(numberString());</span>
            }

<span class="fc bfc" id="L5286" title="All 2 branches covered.">            if (chLocal == 'D') {</span>
<span class="fc" id="L5287">                return Double.parseDouble(numberString());</span>
            }

<span class="fc bfc" id="L5290" title="All 2 branches covered.">            if (decimal) {</span>
<span class="fc" id="L5291">                return decimalValue();</span>
            } else {
<span class="fc" id="L5293">                return doubleValue();</span>
            }
<span class="fc" id="L5295">        } catch (NumberFormatException ex) {</span>
<span class="fc" id="L5296">            throw new JSONException(ex.getMessage() + &quot;, &quot; + info());</span>
        }
    }

    public abstract BigDecimal decimalValue();

    public static boolean isWhitespace(char ch) {
        // 专门调整了判断顺序
<span class="fc bfc" id="L5304" title="All 14 branches covered.">        return ch &lt;= ' '  &amp;&amp;</span>
              (ch == ' '  ||
               ch == '\n' ||
               ch == '\r' ||
               ch == '\t' ||
               ch == '\f' ||
               ch == '\b');
    }

    protected static final long  MULTMIN_RADIX_TEN     = Long.MIN_VALUE / 10;
    protected static final int   INT_MULTMIN_RADIX_TEN = Integer.MIN_VALUE / 10;

<span class="fc" id="L5316">    protected final static int[] digits                = new int[(int) 'f' + 1];</span>

    static {
<span class="fc bfc" id="L5319" title="All 2 branches covered.">        for (int i = '0'; i &lt;= '9'; ++i) {</span>
<span class="fc" id="L5320">            digits[i] = i - '0';</span>
        }

<span class="fc bfc" id="L5323" title="All 2 branches covered.">        for (int i = 'a'; i &lt;= 'f'; ++i) {</span>
<span class="fc" id="L5324">            digits[i] = (i - 'a') + 10;</span>
        }
<span class="fc bfc" id="L5326" title="All 2 branches covered.">        for (int i = 'A'; i &lt;= 'F'; ++i) {</span>
<span class="fc" id="L5327">            digits[i] = (i - 'A') + 10;</span>
        }
<span class="fc" id="L5329">    }</span>

    /**
     * hsf support
     * @param fieldName
     * @param argTypesCount
     * @param typeSymbolTable
     * @return
     */
    public String[] scanFieldStringArray(char[] fieldName, int argTypesCount, SymbolTable typeSymbolTable) {
<span class="nc" id="L5339">        throw new UnsupportedOperationException();</span>
    }

    public boolean matchField2(char[] fieldName) {
<span class="nc" id="L5343">        throw new UnsupportedOperationException();</span>
    }

    public int getFeatures() {
<span class="fc" id="L5347">        return this.features;</span>
    }

    public void setFeatures(int features) {
<span class="nc" id="L5351">        this.features = features;</span>
<span class="nc" id="L5352">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>